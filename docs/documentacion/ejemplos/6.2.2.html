<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-documentacion/ejemplos/6.2.2" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">6.2.2 Configurar journald | Proyecto de Hardening</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://luisealmeida.github.io/hardening/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://luisealmeida.github.io/hardening/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://luisealmeida.github.io/hardening/docs/documentacion/ejemplos/6.2.2"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="6.2.2 Configurar journald | Proyecto de Hardening"><meta data-rh="true" name="description" content="El paquete systemd incluye un servicio de registro llamado systemd-journald.service para la recopilación y almacenamiento de datos de registro. Este servicio crea y mantiene diarios estructurados e indexados basados en información de registro proveniente de diversas fuentes, tales como:"><meta data-rh="true" property="og:description" content="El paquete systemd incluye un servicio de registro llamado systemd-journald.service para la recopilación y almacenamiento de datos de registro. Este servicio crea y mantiene diarios estructurados e indexados basados en información de registro proveniente de diversas fuentes, tales como:"><link data-rh="true" rel="icon" href="/hardening/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://luisealmeida.github.io/hardening/docs/documentacion/ejemplos/6.2.2"><link data-rh="true" rel="alternate" href="https://luisealmeida.github.io/hardening/docs/documentacion/ejemplos/6.2.2" hreflang="en"><link data-rh="true" rel="alternate" href="https://luisealmeida.github.io/hardening/docs/documentacion/ejemplos/6.2.2" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/hardening/blog/rss.xml" title="Proyecto de Hardening RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/hardening/blog/atom.xml" title="Proyecto de Hardening Atom Feed"><link rel="stylesheet" href="/hardening/assets/css/styles.4c7a7165.css">
<script src="/hardening/assets/js/runtime~main.9e8c6a70.js" defer="defer"></script>
<script src="/hardening/assets/js/main.62e36d66.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/hardening/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/hardening/"><div class="navbar__logo"><img src="/hardening/img/logo.svg" alt="Proyecto de Hardening" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/hardening/img/logo.svg" alt="Proyecto de Hardening" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/hardening/docs/documentacion/intro">Documentación</a><a class="navbar__item navbar__link" href="/hardening/blog">Blog</a></div><div class="navbar__items navbar__items--right"><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/hardening/docs/documentacion/intro">Introducción al proyecto</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/hardening/docs/category/ficha-ejecutiva">Ficha Ejecutiva</a><button aria-label="Expand sidebar category &#x27;Ficha Ejecutiva&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/hardening/docs/category/ejemplos">Ejemplos</a><button aria-label="Collapse sidebar category &#x27;Ejemplos&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/hardening/docs/documentacion/ejemplos/estructura">Estructura Sugerida</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/hardening/docs/documentacion/ejemplos/ejemplo1">Ejemplo 1 - 5.1.1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/hardening/docs/documentacion/ejemplos/ejemplo2">Ejemplo 2 - 5.2.1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/hardening/docs/documentacion/ejemplos/ejemplo3">Ejemplo 2 - 7.1.2.3</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/hardening/docs/documentacion/ejemplos/6.2.1.4">6.2.1.4 Asegurarse de que solo se use un sistema de registro (Automatizado)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/hardening/docs/documentacion/ejemplos/6.2.2">6.2.2 Configurar journald</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/hardening/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/hardening/docs/category/ejemplos"><span itemprop="name">Ejemplos</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">6.2.2 Configurar journald</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>6.2.2 Configurar journald</h1></header>
<p>El paquete <code>systemd</code> incluye un servicio de registro llamado systemd-journald.service para la recopilación y almacenamiento de datos de registro. Este servicio crea y mantiene <strong>diarios estructurados e indexados</strong> basados en información de registro proveniente de diversas fuentes, tales como:</p>
<ul>
<li><strong>Registros clásicos RFC3164 BSD syslog</strong> a través del socket <code>/dev/log</code>.</li>
<li><strong>STDOUT/STDERR de programas</strong> mediante <code>StandardOutput=journal</code> y <code>StandardError=journal</code> en archivos de servicio (ambos son configuraciones predeterminadas).</li>
<li><strong>Mensajes del kernel</strong> a través del nodo de dispositivo <code>/dev/kmsg</code>.</li>
<li><strong>Registros de auditoría</strong> mediante el subsistema de auditoría del kernel.</li>
<li><strong>Mensajes de registro estructurados</strong> a través del protocolo nativo de <code>journald</code>.</li>
</ul>
<p>Cualquier cambio realizado en la configuración de <code>systemd-journald</code> requerirá un reinicio del servicio.</p>
<blockquote>
<p>ℹ <strong>Nota:</strong></p>
<ul>
<li><strong>IF</strong> - Si se utilizará <code>rsyslog</code> para el registro remoto en el sistema, esta subsección puede omitirse.</li>
</ul>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="6221-configurar-systemd-journal-remote">6.2.2.1 Configurar <code>systemd-journal-remote</code><a href="#6221-configurar-systemd-journal-remote" class="hash-link" aria-label="Direct link to 6221-configurar-systemd-journal-remote" title="Direct link to 6221-configurar-systemd-journal-remote">​</a></h2>
<p>El paquete <code>systemd-journal-remote</code> incluye <code>systemd-journal-upload</code>.</p>
<ul>
<li>
<p><code>systemd-journal-upload</code> cargará las entradas del diario a la URL especificada con <code>--url=</code>.<br>
<!-- -->Este programa lee entradas del diario desde uno o más archivos de registro, de manera similar a <code>journalctl</code>.</p>
</li>
<li>
<p><code>systemd-journal-upload</code> transfiere el contenido sin procesar de los archivos del diario y utiliza <strong>HTTP</strong> como protocolo de transporte.</p>
</li>
<li>
<p><code>systemd-journal-upload.service</code> es un servicio del sistema que usa <code>systemd-journal-upload</code> para cargar entradas del diario a un servidor.<br>
<!-- -->Utiliza la configuración definida en <code>journal-upload.conf</code>.</p>
</li>
</ul>
<blockquote>
<p>ℹ <strong>Nota:</strong></p>
<ul>
<li><strong>IF</strong> - Si <code>rsyslog</code> está en uso, esta subsección puede omitirse.</li>
</ul>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="6221-asegurar-que-systemd-journal-remote-esté-instalado-automatizado">6.2.2.1 Asegurar que systemd-journal-remote esté instalado (Automatizado)<a href="#6221-asegurar-que-systemd-journal-remote-esté-instalado-automatizado" class="hash-link" aria-label="Direct link to 6.2.2.1 Asegurar que systemd-journal-remote esté instalado (Automatizado)" title="Direct link to 6.2.2.1 Asegurar que systemd-journal-remote esté instalado (Automatizado)">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="aplicabilidad-del-perfil">Aplicabilidad del perfil:<a href="#aplicabilidad-del-perfil" class="hash-link" aria-label="Direct link to Aplicabilidad del perfil:" title="Direct link to Aplicabilidad del perfil:">​</a></h4>
<ul>
<li>Nivel 1 - Servidor</li>
<li>Nivel 1 - Estación de trabajo</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="descripción">Descripción:<a href="#descripción" class="hash-link" aria-label="Direct link to Descripción:" title="Direct link to Descripción:">​</a></h4>
<p>Journal <strong>systemd-journal-remote</strong> admite la capacidad de enviar eventos de registro que recopila a un host de registro remoto o recibir mensajes de hosts remotos, lo que permite la gestión centralizada de registros.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="justificación">Justificación:<a href="#justificación" class="hash-link" aria-label="Direct link to Justificación:" title="Direct link to Justificación:">​</a></h4>
<p>Almacenar datos de registro en un host remoto protege la integridad de los registros contra ataques locales. Si un atacante obtiene acceso root en el sistema local, podría manipular o eliminar datos de registro almacenados en el sistema local.</p>
<blockquote>
<p>ℹ <strong>Nota:</strong> Esta recomendación <strong>solo aplica si journald es el método elegido para el registro del cliente</strong>. No aplique esta recomendación si se utiliza <strong>rsyslog</strong>.</p>
</blockquote>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="auditoría">Auditoría:<a href="#auditoría" class="hash-link" aria-label="Direct link to Auditoría:" title="Direct link to Auditoría:">​</a></h4>
<ul>
<li><strong>SI</strong> se utilizará <code>journald</code> para el registro en el sistema:
Ejecute el siguiente comando para verificar que <strong>systemd-journal-remote</strong> está instalado:</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rpm -q systemd-journal-remote</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Verifique que la salida coincida con:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">systemd-journal-remote-&lt;versión&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="remediación">Remediación:<a href="#remediación" class="hash-link" aria-label="Direct link to Remediación:" title="Direct link to Remediación:">​</a></h4>
<p>Ejecute el siguiente comando para instalar <code>systemd-journal-remote</code>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dnf install systemd-journal-remote</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="referencias">Referencias:<a href="#referencias" class="hash-link" aria-label="Direct link to Referencias:" title="Direct link to Referencias:">​</a></h4>
<ol>
<li>NIST SP 800-53 Rev. 5: AU-2, AU-7 AU-12</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="controles-cis">Controles CIS:<a href="#controles-cis" class="hash-link" aria-label="Direct link to Controles CIS:" title="Direct link to Controles CIS:">​</a></h2>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="62212-asegurar-que-la-autenticación-de-systemd-journal-upload-esté-configurada-manual">6.2.2.1.2 Asegurar que la autenticación de systemd-journal-upload esté configurada (Manual)<a href="#62212-asegurar-que-la-autenticación-de-systemd-journal-upload-esté-configurada-manual" class="hash-link" aria-label="Direct link to 6.2.2.1.2 Asegurar que la autenticación de systemd-journal-upload esté configurada (Manual)" title="Direct link to 6.2.2.1.2 Asegurar que la autenticación de systemd-journal-upload esté configurada (Manual)">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="aplicabilidad-del-perfil-1">Aplicabilidad del perfil:<a href="#aplicabilidad-del-perfil-1" class="hash-link" aria-label="Direct link to Aplicabilidad del perfil:" title="Direct link to Aplicabilidad del perfil:">​</a></h3>
<ul>
<li>Nivel 1 - Servidor</li>
<li>Nivel 1 - Estación de trabajo</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="descripción-1">Descripción:<a href="#descripción-1" class="hash-link" aria-label="Direct link to Descripción:" title="Direct link to Descripción:">​</a></h3>
<p>Journal <strong>systemd-journal-upload</strong> admite la capacidad de enviar eventos de registro que recopila a un host de registro remoto.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="justificación-1">Justificación:<a href="#justificación-1" class="hash-link" aria-label="Direct link to Justificación:" title="Direct link to Justificación:">​</a></h3>
<p>Almacenar datos de registro en un host remoto protege la integridad de los registros contra ataques locales. Si un atacante obtiene acceso root en el sistema local, podría manipular o eliminar datos de registro almacenados en el sistema local.</p>
<blockquote>
<p>ℹ <strong>Nota:</strong> Esta recomendación <strong>solo aplica si journald es el método elegido para el registro del cliente</strong>. No aplique esta recomendación si se utiliza <strong>rsyslog</strong>.</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="auditoría-1">Auditoría:<a href="#auditoría-1" class="hash-link" aria-label="Direct link to Auditoría:" title="Direct link to Auditoría:">​</a></h3>
<p>Ejecute el siguiente comando para verificar que la autenticación de <strong>systemd-journal-upload</strong> está configurada:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">grep -P &quot;^ *URL=|^ *ServerKeyFile=|^ *ServerCertificateFile=|^ *TrustedCertificateFile=&quot; /etc/systemd/journal-upload.conf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Verifique que la salida coincida con las ubicaciones de los certificados de su entorno y la URL del servidor de registros:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[Upload] </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">URL=192.168.50.42</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ServerKeyFile=/etc/ssl/private/journal-upload.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ServerCertificateFile=/etc/ssl/certs/journal-upload.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TrustedCertificateFile=/etc/ssl/ca/trusted.pem</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="remediación-1">Remediación:<a href="#remediación-1" class="hash-link" aria-label="Direct link to Remediación:" title="Direct link to Remediación:">​</a></h3>
<p>Edite el archivo <code>/etc/systemd/journal-upload.conf</code> o un archivo en<br>
<code>/etc/systemd/journal-upload.conf.d</code> con la extensión <code>.conf</code> y asegúrese de que las siguientes líneas estén configuradas en la sección <code>[Upload]</code> según su entorno:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[Upload]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">URL=192.168.50.42</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ServerKeyFile=/etc/ssl/private/journal-upload.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ServerCertificateFile=/etc/ssl/certs/journal-upload.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TrustedCertificateFile=/etc/ssl/ca/trusted.pem</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Reiniciar el servicio:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">systemctl restart systemd-journal-upload</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="referencias-1">Referencias<a href="#referencias-1" class="hash-link" aria-label="Direct link to Referencias" title="Direct link to Referencias">​</a></h3>
<ol>
<li>NIST SP 800-53 Rev. 5: AU-2, AU-12</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="controles-cis-1">Controles CIS:<a href="#controles-cis-1" class="hash-link" aria-label="Direct link to Controles CIS:" title="Direct link to Controles CIS:">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="62213-asegurar-que-systemd-journal-upload-esté-habilitado-y-activo-automatizado">6.2.2.1.3 Asegurar que systemd-journal-upload esté habilitado y activo (Automatizado)<a href="#62213-asegurar-que-systemd-journal-upload-esté-habilitado-y-activo-automatizado" class="hash-link" aria-label="Direct link to 6.2.2.1.3 Asegurar que systemd-journal-upload esté habilitado y activo (Automatizado)" title="Direct link to 6.2.2.1.3 Asegurar que systemd-journal-upload esté habilitado y activo (Automatizado)">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="aplicabilidad-del-perfil-2">Aplicabilidad del perfil:<a href="#aplicabilidad-del-perfil-2" class="hash-link" aria-label="Direct link to Aplicabilidad del perfil:" title="Direct link to Aplicabilidad del perfil:">​</a></h4>
<ul>
<li>Nivel 1 - Servidor</li>
<li>Nivel 1 - Estación de trabajo</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="descripción-2">Descripción:<a href="#descripción-2" class="hash-link" aria-label="Direct link to Descripción:" title="Direct link to Descripción:">​</a></h4>
<p>Journal <strong>systemd-journal-upload</strong> admite la capacidad de enviar eventos de registro que recopila a un host de registro remoto.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="justificación-2">Justificación:<a href="#justificación-2" class="hash-link" aria-label="Direct link to Justificación:" title="Direct link to Justificación:">​</a></h4>
<p>Almacenar datos de registro en un host remoto protege la integridad de los registros contra ataques locales. Si un atacante obtiene acceso root en el sistema local, podría manipular o eliminar datos de registro almacenados en el sistema local.</p>
<blockquote>
<p>ℹ <strong>Nota:</strong> Esta recomendación <strong>solo aplica si journald es el método elegido para el registro del cliente</strong>. No aplique esta recomendación si se utiliza <strong>rsyslog</strong>.</p>
</blockquote>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="auditoría-2">Auditoría:<a href="#auditoría-2" class="hash-link" aria-label="Direct link to Auditoría:" title="Direct link to Auditoría:">​</a></h4>
<p>Ejecute el siguiente comando para verificar que <code>systemd-journal-upload</code> está habilitado:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># systemctl is-enabled systemd-journal-upload.service enabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enabled</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Ejecute el siguiente comando para verificar que <code>systemd-journal-upload</code> esté activo:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># systemctl is-active systemd-journal-upload.service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">active</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="remediación-2">Remediación:<a href="#remediación-2" class="hash-link" aria-label="Direct link to Remediación:" title="Direct link to Remediación:">​</a></h4>
<p>Ejecute los siguientes comandos para desenmascarar, habilitar e iniciar <code>systemd-journal-upload</code>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># systemctl unmask systemd-journal-upload.service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># systemctl --now enable systemd-journal-upload.service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">active</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="referencia">Referencia:<a href="#referencia" class="hash-link" aria-label="Direct link to Referencia:" title="Direct link to Referencia:">​</a></h4>
<ol>
<li>NIST SP 800-53 Rev. 5: AU-2, AU-12</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="controles-cis-2">Controles CIS:<a href="#controles-cis-2" class="hash-link" aria-label="Direct link to Controles CIS:" title="Direct link to Controles CIS:">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="62214-asegurar-que-el-servicio-systemd-journal-remote-no-esté-en-uso-automatizado">6.2.2.1.4 Asegurar que el servicio systemd-journal-remote no esté en uso (Automatizado)<a href="#62214-asegurar-que-el-servicio-systemd-journal-remote-no-esté-en-uso-automatizado" class="hash-link" aria-label="Direct link to 6.2.2.1.4 Asegurar que el servicio systemd-journal-remote no esté en uso (Automatizado)" title="Direct link to 6.2.2.1.4 Asegurar que el servicio systemd-journal-remote no esté en uso (Automatizado)">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="aplicabilidad-del-perfil-3">Aplicabilidad del perfil:<a href="#aplicabilidad-del-perfil-3" class="hash-link" aria-label="Direct link to Aplicabilidad del perfil:" title="Direct link to Aplicabilidad del perfil:">​</a></h4>
<ul>
<li>Nivel 1 - Servidor</li>
<li>Nivel 1 - Estación de trabajo</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="descripción-3">Descripción:<a href="#descripción-3" class="hash-link" aria-label="Direct link to Descripción:" title="Direct link to Descripción:">​</a></h4>
<p>Journal <code>systemd-journal-remote</code> admite la capacidad de recibir mensajes de hosts remotos, actuando así como un servidor de registros. Los clientes no deberían recibir datos de otros hosts.</p>
<blockquote>
<p>ℹ <strong>Nota:</strong></p>
<ul>
<li>El mismo paquete, <code>systemd-journal-remote</code>, se usa tanto para enviar registros a hosts remotos como para recibir registros entrantes.</li>
<li>En cuanto a la recepción de registros, existen dos servicios: <code>systemd-journal-remote.socket</code> y <code>systemd-journal-remote.service</code>.</li>
</ul>
</blockquote>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="justificación-3">Justificación:<a href="#justificación-3" class="hash-link" aria-label="Direct link to Justificación:" title="Direct link to Justificación:">​</a></h4>
<p>Si un cliente está configurado para recibir datos, convirtiéndose en un servidor, el sistema cliente está operando fuera de su límite funcional.</p>
<blockquote>
<p>ℹ <strong>Nota:</strong> Esta recomendación <strong>solo aplica si journald es el método elegido para el registro del cliente</strong>. No aplique esta recomendación si se utiliza <code>rsyslog</code>.</p>
</blockquote>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="auditoría-3">Auditoría:<a href="#auditoría-3" class="hash-link" aria-label="Direct link to Auditoría:" title="Direct link to Auditoría:">​</a></h4>
<p>Ejecute el siguiente comando para verificar que <code>systemd-journal-remote.socket</code> y <code>systemd-journal-remote.service</code> no estén habilitados:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># systemctl is-enabled systemd-journal-remote.socket systemd-journal-remote.service | grep -P -- &#x27;^enabled&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>No se debe devolver nada
Ejecute el siguiente comando para verificar que <code>systemd-journal-remote.socket</code> y <code>systemd-journal-remote.service</code> no estén activos:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># systemctl is-active systemd-journal-remote.socket systemd-journal-remote.service | grep -P -- &#x27;^active&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>No se debe devolver nada</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="reneduación">Reneduación<a href="#reneduación" class="hash-link" aria-label="Direct link to Reneduación" title="Direct link to Reneduación">​</a></h4>
<p>Ejecute los siguientes comandos para detener y enmascarar systemd-journal-remote.socket y systemd-journal-remote.service:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># systemctl stop systemd-journal-remote.socket systemd-journal-remote.service </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># systemctl mask systemd-journal-remote.socket systemd-journal-remote.service</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="referencias-2">Referencias:<a href="#referencias-2" class="hash-link" aria-label="Direct link to Referencias:" title="Direct link to Referencias:">​</a></h4>
<ol>
<li>NIST SP 800-53 Rev. 5: AU-2, AU-7 AU-12</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="controles-cis-3">Controles CIS:<a href="#controles-cis-3" class="hash-link" aria-label="Direct link to Controles CIS:" title="Direct link to Controles CIS:">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="6222-asegurar-que-forwardtosyslog-de-journald-esté-deshabilitado-automatizado">6.2.2.2 Asegurar que ForwardToSyslog de journald esté deshabilitado (Automatizado)<a href="#6222-asegurar-que-forwardtosyslog-de-journald-esté-deshabilitado-automatizado" class="hash-link" aria-label="Direct link to 6.2.2.2 Asegurar que ForwardToSyslog de journald esté deshabilitado (Automatizado)" title="Direct link to 6.2.2.2 Asegurar que ForwardToSyslog de journald esté deshabilitado (Automatizado)">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="aplicabilidad-del-perfil-4">Aplicabilidad del perfil:<a href="#aplicabilidad-del-perfil-4" class="hash-link" aria-label="Direct link to Aplicabilidad del perfil:" title="Direct link to Aplicabilidad del perfil:">​</a></h4>
<ul>
<li>Nivel 1 - Servidor</li>
<li>Nivel 1 - Estación de trabajo</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="descripción-4">Descripción:<a href="#descripción-4" class="hash-link" aria-label="Direct link to Descripción:" title="Direct link to Descripción:">​</a></h4>
<p>Los datos de <strong>journald</strong> deben permanecer dentro del servicio y no ser reenviados a otros servicios.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="justificación-4">Justificación:<a href="#justificación-4" class="hash-link" aria-label="Direct link to Justificación:" title="Direct link to Justificación:">​</a></h4>
<ul>
<li><strong>SI</strong> <strong>journald</strong> es el método para capturar registros, todos los registros del sistema deben ser manejados por <strong>journald</strong> y no ser reenviados a otros mecanismos de registro.</li>
</ul>
<blockquote>
<p>ℹ <strong>Nota:</strong> Esta recomendación <strong>solo aplica si journald es el método elegido para el registro del cliente</strong>. No aplique esta recomendación si se utiliza <strong>rsyslog</strong>.</p>
</blockquote>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="auditoría-4">Auditoría:<a href="#auditoría-4" class="hash-link" aria-label="Direct link to Auditoría:" title="Direct link to Auditoría:">​</a></h4>
<ul>
<li><strong>SI</strong> <strong>journald</strong> es el método para capturar registros<br>
<!-- -->Ejecute el siguiente comando para verificar que <strong>ForwardToSyslog</strong> esté configurado en <strong>no</strong>:</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># systemd-analyze cat-config systemd/journald.conf systemd/journald.conf.d/*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| grep -E &quot;^ForwardToSyslog=no&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ForwardToSyslog=no</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="remediación-3">Remediación:<a href="#remediación-3" class="hash-link" aria-label="Direct link to Remediación:" title="Direct link to Remediación:">​</a></h4>
<ul>
<li>
<p><strong>SI</strong> <code>rsyslog</code> es el método preferido para capturar registros, esta sección y la recomendación deben omitirse, y se debe seguir la sección &quot;Configurar rsyslog&quot;.</p>
</li>
<li>
<p><strong>SI</strong> <code>journald</code> es el método preferido para capturar registros:</p>
<p>Establezca el siguiente parámetro en la sección <strong>[Journal]</strong> en <code>/etc/systemd/journald.conf</code> o en un archivo dentro de <code>/etc/systemd/journald.conf.d/</code> que termine en <code>.conf</code>:</p>
</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ForwardToSyslog=no</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ejemplos</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#!/usr/bin/env bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [ ! -d /etc/systemd/journald.conf.d/ ] &amp;&amp; mkdir /etc/systemd/journald.conf.d/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if grep -Psq -- &#x27;^\h*\t*\[Journal\]&#x27; /etc/systemd/journald.conf.d/60-journald.conf; then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printf &#x27;%s\n&#x27; &quot;ForwardToSyslog=no&quot; &gt;&gt; /etc/systemd/journald.conf.d/60-journald.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printf &#x27;%s\n&#x27; &quot;[Journal]&quot; &quot;ForwardToSyslog=no&quot; &gt;&gt; /etc/systemd/journald.conf.d/60-journald.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>ℹ <strong>Nota:</strong>
Si esta configuración aparece en un archivo canónicamente posterior o más adelante en el mismo archivo, la configuración será sobrescrita.</p>
</blockquote>
<p>Ejecute el siguiente comando para actualizar los parámetros en el servicio:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># systemctl reload-or-restart systemd-journald</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Valor por defecto:
ForwardToSyslog=no</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="referencias-3">Referencias:<a href="#referencias-3" class="hash-link" aria-label="Direct link to Referencias:" title="Direct link to Referencias:">​</a></h4>
<ol>
<li>NIST SP 800-53 Rev. 5: AU-2, AU-6, AU-7, AU-12</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="controles-cis-4">Controles CIS:<a href="#controles-cis-4" class="hash-link" aria-label="Direct link to Controles CIS:" title="Direct link to Controles CIS:">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="6223-asegurar-que-journald-compress-esté-configurado-automatizado">6.2.2.3 Asegurar que journald Compress esté configurado (Automatizado)<a href="#6223-asegurar-que-journald-compress-esté-configurado-automatizado" class="hash-link" aria-label="Direct link to 6.2.2.3 Asegurar que journald Compress esté configurado (Automatizado)" title="Direct link to 6.2.2.3 Asegurar que journald Compress esté configurado (Automatizado)">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="aplicabilidad-del-perfil-5">Aplicabilidad del perfil:<a href="#aplicabilidad-del-perfil-5" class="hash-link" aria-label="Direct link to Aplicabilidad del perfil:" title="Direct link to Aplicabilidad del perfil:">​</a></h4>
<ul>
<li>Nivel 1 - Servidor</li>
<li>Nivel 1 - Estación de trabajo</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="descripción-5">Descripción:<a href="#descripción-5" class="hash-link" aria-label="Direct link to Descripción:" title="Direct link to Descripción:">​</a></h4>
<p>El sistema <strong>journald</strong> incluye la capacidad de comprimir archivos excesivamente grandes para evitar que el sistema se llene con registros o que los registros sean incontrolablemente grandes.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="justificación-5">Justificación:<a href="#justificación-5" class="hash-link" aria-label="Direct link to Justificación:" title="Direct link to Justificación:">​</a></h4>
<p>Los archivos grandes sin comprimir pueden llenar inesperadamente un sistema de archivos, lo que lleva a la indisponibilidad de recursos. Comprimir los registros antes de escribirlos puede prevenir impactos repentinos e inesperados en el sistema de archivos.</p>
<blockquote>
<p>ℹ <strong>Nota:</strong> Esta recomendación <strong>solo aplica si journald es el método elegido para el registro del cliente</strong>. No aplique esta recomendación si se utiliza <strong>rsyslog</strong>.</p>
</blockquote>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="auditoría-5">Auditoría:<a href="#auditoría-5" class="hash-link" aria-label="Direct link to Auditoría:" title="Direct link to Auditoría:">​</a></h4>
<p>Ejecute el siguiente comando para verificar que <strong>Compress</strong> esté configurado en <strong>yes</strong>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># systemd-analyze cat-config systemd/journald.conf systemd/journald.conf.d/* \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| grep -E &quot;^Compress=yes&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Compress=yes</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="remediación-4">Remediación:<a href="#remediación-4" class="hash-link" aria-label="Direct link to Remediación:" title="Direct link to Remediación:">​</a></h4>
<p>Establezca el siguiente parámetro en la sección <code>[Journal]</code> en <code>/etc/systemd/journald.conf</code> o en un archivo dentro de <code>/etc/systemd/journald.conf.d/</code> que termine en <code>.conf</code>:</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="ejemplo">Ejemplo:<a href="#ejemplo" class="hash-link" aria-label="Direct link to Ejemplo:" title="Direct link to Ejemplo:">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#!/usr/bin/env bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [ ! -d /etc/systemd/journald.conf.d/ ] &amp;&amp; mkdir /etc/systemd/journald.conf.d/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if grep -Psq -- &#x27;^\h*\t*\[Journal\]&#x27; /etc/systemd/journald.conf.d/60-journald.conf; then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printf &#x27;%s\n&#x27; &quot;Compress=yes&quot; &gt;&gt; /etc/systemd/journald.conf.d/60-journald.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printf &#x27;%s\n&#x27; &quot;[Journal]&quot; &quot;Compress=yes&quot; &gt;&gt; /etc/systemd/journald.conf.d/60-journald.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>ℹ <strong>Nota:</strong>
Si esta configuración aparece en un archivo canónicamente posterior o más adelante en el mismo archivo, la configuración será sobrescrita.</p>
</blockquote>
<p>Ejecute el siguiente comando para actualizar los parámetros en el servicio:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># systemctl reload-or-restart systemd-journald</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="referencias-4">Referencias<a href="#referencias-4" class="hash-link" aria-label="Direct link to Referencias" title="Direct link to Referencias">​</a></h4>
<ol>
<li>NIST SP 800-53 Rev. 5: AU-4</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="controles-cis-5">Controles CIS:<a href="#controles-cis-5" class="hash-link" aria-label="Direct link to Controles CIS:" title="Direct link to Controles CIS:">​</a></h2>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="mapeo-de-mitre-attck">Mapeo de MITRE ATT&amp;CK:<a href="#mapeo-de-mitre-attck" class="hash-link" aria-label="Direct link to Mapeo de MITRE ATT&amp;CK:" title="Direct link to Mapeo de MITRE ATT&amp;CK:">​</a></h2>
<table><thead><tr><th>Técnicas / Subtécnicas</th><th>Tácticas</th><th>Mitigaciones</th></tr></thead><tbody><tr><td>T1562, T1562.001</td><td>TA0040</td><td>M1053</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="6224-asegurar-que-journald-storage-esté-configurado-automatizado">6.2.2.4 Asegurar que journald Storage esté configurado (Automatizado)<a href="#6224-asegurar-que-journald-storage-esté-configurado-automatizado" class="hash-link" aria-label="Direct link to 6.2.2.4 Asegurar que journald Storage esté configurado (Automatizado)" title="Direct link to 6.2.2.4 Asegurar que journald Storage esté configurado (Automatizado)">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="aplicabilidad-del-perfil-6">Aplicabilidad del perfil:<a href="#aplicabilidad-del-perfil-6" class="hash-link" aria-label="Direct link to Aplicabilidad del perfil:" title="Direct link to Aplicabilidad del perfil:">​</a></h4>
<ul>
<li>Nivel 1 - Servidor</li>
<li>Nivel 1 - Estación de trabajo</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="descripción-6">Descripción:<a href="#descripción-6" class="hash-link" aria-label="Direct link to Descripción:" title="Direct link to Descripción:">​</a></h4>
<p>Los datos de <strong>journald</strong> pueden almacenarse en memoria volátil o persistirse localmente en el servidor.<br>
<!-- -->Los registros en memoria se perderán tras un reinicio del sistema.<br>
<!-- -->Al persistir los registros en el disco local del servidor, están protegidos contra la pérdida de datos debido a un reinicio.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="justificación-6">Justificación:<a href="#justificación-6" class="hash-link" aria-label="Direct link to Justificación:" title="Direct link to Justificación:">​</a></h4>
<p>Escribir los datos de registro en el disco permite la capacidad de reconstrucción forense de eventos<br>
<!-- -->que pudieron haber afectado las operaciones o la seguridad de un sistema, incluso después de un fallo o reinicio.</p>
<blockquote>
<p>ℹ <strong>Nota:</strong> Esta recomendación <strong>solo aplica si <code>journald</code> es el método elegido para el registro del cliente</strong>. No aplique esta recomendación si se utiliza <code>rsyslog</code>.</p>
</blockquote>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="auditoría-6">Auditoría:<a href="#auditoría-6" class="hash-link" aria-label="Direct link to Auditoría:" title="Direct link to Auditoría:">​</a></h4>
<p>Ejecute el siguiente comando para verificar que <code>Storage</code> esté configurado en <code>persistent</code>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># systemd-analyze cat-config systemd/journald.conf systemd/journald.conf.d/* \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| grep -E &quot;^Storage=persistent&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Storage=persistent</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="remediación-5">Remediación:<a href="#remediación-5" class="hash-link" aria-label="Direct link to Remediación:" title="Direct link to Remediación:">​</a></h4>
<p>Establezca el siguiente parámetro en la sección <code>[Journal]</code> en <code>/etc/systemd/journald.conf</code> o en un archivo dentro de <code>/etc/systemd/journald.conf.d/</code> que termine en <code>.conf</code>:</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="ejemplo-1">Ejemplo:<a href="#ejemplo-1" class="hash-link" aria-label="Direct link to Ejemplo:" title="Direct link to Ejemplo:">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#!/usr/bin/env bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [ ! -d /etc/systemd/journald.conf.d/ ] &amp;&amp; mkdir /etc/systemd/journald.conf.d/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if grep -Psq -- &#x27;^\h*\t*\[Journal\]&#x27; /etc/systemd/journald.conf.d/60-journald.conf; then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printf &#x27;%s\n&#x27; &quot;Storage=persistent&quot; &gt;&gt; /etc/systemd/journald.conf.d/60-journald.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printf &#x27;%s\n&#x27; &quot;[Journal]&quot; &quot;Storage=persistent&quot; &gt;&gt; /etc/systemd/journald.conf.d/60-journald.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>ℹ <strong>Nota:</strong>
Si esta configuración aparece en un archivo canónicamente posterior o más adelante en el mismo archivo, la configuración será sobrescrita.</p>
</blockquote>
<p>Ejecute el siguiente comando para actualizar los parámetros en el servicio:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># systemctl reload-or-restart systemd-journald</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="referencia-1">Referencia<a href="#referencia-1" class="hash-link" aria-label="Direct link to Referencia" title="Direct link to Referencia">​</a></h4>
<ol>
<li>NIST SP 800-53 Rev. 5: AU-3, AU-12</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="controles-cis-6">Controles CIS:<a href="#controles-cis-6" class="hash-link" aria-label="Direct link to Controles CIS:" title="Direct link to Controles CIS:">​</a></h2>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="mapeo-de-mitre-attck-1">Mapeo de MITRE ATT&amp;CK:<a href="#mapeo-de-mitre-attck-1" class="hash-link" aria-label="Direct link to Mapeo de MITRE ATT&amp;CK:" title="Direct link to Mapeo de MITRE ATT&amp;CK:">​</a></h2>
<table><thead><tr><th>Técnicas / Subtécnicas</th><th>Tácticas</th><th>Mitigaciones</th></tr></thead><tbody><tr><td>T1070, T1070.002, T1562, T1562.006</td><td>TA0005</td><td>M1022</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="623-configurar-rsyslog">6.2.3 Configurar rsyslog<a href="#623-configurar-rsyslog" class="hash-link" aria-label="Direct link to 6.2.3 Configurar rsyslog" title="Direct link to 6.2.3 Configurar rsyslog">​</a></h2>
<p>El paquete de software <code>rsyslog</code> puede utilizarse en lugar del mecanismo de registro predeterminado <code>journald</code>.</p>
<p>Rsyslog ha evolucionado a lo largo de varias décadas. Por esta razón, admite tres formatos de configuración diferentes (&quot;lenguajes&quot;):</p>
<ul>
<li>
<p><strong><code>básico</code></strong> - anteriormente conocido como el formato <code>sysklogd</code>, este es el formato mejor utilizado para expresar configuraciones simples, como la ubicación de una declaración en una sola línea.</p>
<ul>
<li>Se remonta al formato original <code>syslog.conf</code>, que ha estado en uso durante varias décadas.</li>
<li>El caso de uso más común es la coincidencia basada en facilidad/gravedad y la escritura de mensajes coincidentes en un archivo de registro.</li>
</ul>
</li>
<li>
<p><strong><code>avanzado</code></strong> - anteriormente conocido como el formato <code>RainerScript</code>, este formato estuvo disponible por primera vez en rsyslog v6 y es el formato más preciso y moderno para casos de uso no triviales donde se necesita más de una línea.</p>
<ul>
<li>Antes de la versión 7, había un impacto en el rendimiento al usar este formato, lo que alentaba el uso del formato básico para obtener mejores resultados. Las versiones actuales de rsyslog no sufren este impacto de rendimiento (histórico).</li>
<li>Este nuevo formato está específicamente dirigido a casos de uso más avanzados, como el reenvío de registros a hosts remotos que podrían estar disponibles solo parcialmente.</li>
</ul>
</li>
<li>
<p><strong><code>obsoleto (legado)</code></strong> - anteriormente conocido simplemente como el formato <code>legacy</code>, este formato es exactamente lo que su nombre indica: obsoleto y no debería usarse al escribir nuevas configuraciones. Fue creado en los primeros días (hasta rsyslog versión 5), cuando se esperaba que rsyslog extendiera <strong>sysklogd</strong> solo ligeramente. En consecuencia, su propósito principal era realizar pequeños ajustes al formato original <strong>sysklogd</strong>.</p>
<ul>
<li>La práctica ha demostrado que era notoriamente difícil de usar para casos de uso más avanzados, por lo que fue reemplazado por el formato avanzado.</li>
<li>En esencia, cualquier configuración escrita en una sola línea que comience con un signo de dólar (<code>$</code>) es un formato legado. Los usuarios de este formato deben <strong>migrar a los formatos básico o avanzado</strong>.</li>
</ul>
</li>
</ul>
<blockquote>
<p>ℹ <strong>Nota:</strong>:
Esta sección <strong>solo aplica si <code>rsyslog</code> es el método elegido para el registro del cliente</strong>. No aplique esta sección si se utiliza <code>journald</code>.</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="6231-asegurar-que-rsyslog-esté-instalado-automatizado">6.2.3.1 Asegurar que rsyslog esté instalado (Automatizado)<a href="#6231-asegurar-que-rsyslog-esté-instalado-automatizado" class="hash-link" aria-label="Direct link to 6.2.3.1 Asegurar que rsyslog esté instalado (Automatizado)" title="Direct link to 6.2.3.1 Asegurar que rsyslog esté instalado (Automatizado)">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="aplicabilidad-del-perfil-7">Aplicabilidad del perfil:<a href="#aplicabilidad-del-perfil-7" class="hash-link" aria-label="Direct link to Aplicabilidad del perfil:" title="Direct link to Aplicabilidad del perfil:">​</a></h4>
<ul>
<li>Nivel 1 - Servidor</li>
<li>Nivel 1 - Estación de trabajo</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="descripción-7">Descripción:<a href="#descripción-7" class="hash-link" aria-label="Direct link to Descripción:" title="Direct link to Descripción:">​</a></h4>
<p>El software <strong>rsyslog</strong> se recomienda en entornos donde <strong>journald</strong> no cumple con los requisitos operativos.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="justificación-7">Justificación:<a href="#justificación-7" class="hash-link" aria-label="Direct link to Justificación:" title="Direct link to Justificación:">​</a></h4>
<p>Las mejoras de seguridad de <strong>rsyslog</strong>, como la transmisión de registros orientada a conexión (por ejemplo, TCP),<br>
<!-- -->la opción de registrar datos en formatos de bases de datos y el cifrado de los registros en tránsito hacia un servidor central de registros,<br>
<!-- -->justifican la instalación y configuración de este paquete.</p>
<blockquote>
<p>ℹ <strong>Nota:</strong>: Esta recomendación <strong>solo aplica si rsyslog es el método elegido para el registro del cliente</strong>.<br>
<!-- -->No aplique esta recomendación si se utiliza <strong>journald</strong>.</p>
</blockquote>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="auditoría-7">Auditoría:<a href="#auditoría-7" class="hash-link" aria-label="Direct link to Auditoría:" title="Direct link to Auditoría:">​</a></h4>
<ul>
<li><strong>SI</strong> <strong>rsyslog</strong> se usa para el registro en el sistema:<br>
<!-- -->Ejecute el siguiente comando para verificar que <strong>rsyslog</strong> está instalado:</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># rpm -q rsyslog</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Verifique que la salida coincida:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rsyslog-&lt;version&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="recomendación">Recomendación:<a href="#recomendación" class="hash-link" aria-label="Direct link to Recomendación:" title="Direct link to Recomendación:">​</a></h4>
<p>Ejecute el siguiente comando para instalar rsyslog:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># dnf install rsyslog</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="valor-predeterminado">Valor predeterminado:<a href="#valor-predeterminado" class="hash-link" aria-label="Direct link to Valor predeterminado:" title="Direct link to Valor predeterminado:">​</a></h4>
<p>Instalado</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="referencias-5">Referencias:<a href="#referencias-5" class="hash-link" aria-label="Direct link to Referencias:" title="Direct link to Referencias:">​</a></h4>
<ol>
<li>NIST SP 800-53 Rev. 5: AU-2, AU-3, AU-12</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="controles-cis-7">Controles CIS:<a href="#controles-cis-7" class="hash-link" aria-label="Direct link to Controles CIS:" title="Direct link to Controles CIS:">​</a></h2>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="mapeo-de-mitre-attck-2">Mapeo de MITRE ATT&amp;CK:<a href="#mapeo-de-mitre-attck-2" class="hash-link" aria-label="Direct link to Mapeo de MITRE ATT&amp;CK:" title="Direct link to Mapeo de MITRE ATT&amp;CK:">​</a></h2>
<table><thead><tr><th>Técnicas / Subtécnicas</th><th>Tácticas</th><th>Mitigaciones</th></tr></thead><tbody><tr><td>T1005, T1005.000, T1070, T1070.002</td><td>TA0005</td><td>M1029, M1057</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="6232-asegurar-que-el-servicio-rsyslog-esté-habilitado-y-activo-automatizado">6.2.3.2 Asegurar que el servicio rsyslog esté habilitado y activo (Automatizado)<a href="#6232-asegurar-que-el-servicio-rsyslog-esté-habilitado-y-activo-automatizado" class="hash-link" aria-label="Direct link to 6.2.3.2 Asegurar que el servicio rsyslog esté habilitado y activo (Automatizado)" title="Direct link to 6.2.3.2 Asegurar que el servicio rsyslog esté habilitado y activo (Automatizado)">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="aplicabilidad-del-perfil-8">Aplicabilidad del perfil:<a href="#aplicabilidad-del-perfil-8" class="hash-link" aria-label="Direct link to Aplicabilidad del perfil:" title="Direct link to Aplicabilidad del perfil:">​</a></h4>
<ul>
<li>Nivel 1 - Servidor</li>
<li>Nivel 1 - Estación de trabajo</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="descripción-8">Descripción:<a href="#descripción-8" class="hash-link" aria-label="Direct link to Descripción:" title="Direct link to Descripción:">​</a></h4>
<p>Una vez que el paquete <strong><code>rsyslog</code></strong> esté instalado, asegúrese de que el servicio esté habilitado.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="justificación-8">Justificación:<a href="#justificación-8" class="hash-link" aria-label="Direct link to Justificación:" title="Direct link to Justificación:">​</a></h4>
<p>Si el servicio <strong><code>rsyslog</code></strong> no está habilitado para iniciarse en el arranque, el sistema no capturará eventos de registro.</p>
<blockquote>
<p>ℹ <strong>Nota:</strong>: Esta recomendación <strong>solo aplica si rsyslog es el método elegido para el registro del cliente</strong>.<br>
<!-- -->No aplique esta recomendación si se utiliza <strong><code>journald</code></strong>.</p>
</blockquote>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="auditoría-8">Auditoría:<a href="#auditoría-8" class="hash-link" aria-label="Direct link to Auditoría:" title="Direct link to Auditoría:">​</a></h4>
<ul>
<li><strong>SI</strong> <strong><code>rsyslog</code></strong> se usa para el registro en el sistema:<br>
<!-- -->Ejecute el siguiente comando para verificar que <strong><code>rsyslog.service</code></strong> está habilitado:</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># systemctl is-enabled rsyslog</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enabled</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Ejecute el siguiente comando para verificar que <code>rsyslog.service</code> está activo:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># systemctl is-active rsyslog.service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">active</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="remediación-6">Remediación:<a href="#remediación-6" class="hash-link" aria-label="Direct link to Remediación:" title="Direct link to Remediación:">​</a></h4>
<p><strong>SI rsyslog</strong> se usa para el registro en el sistema:
Ejecute los siguientes comandos para desmascarar, habilitar e iniciar <code>rsyslog.service</code>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># systemctl unmask rsyslog.service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># systemctl enable rsyslog.service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># systemctl start rsyslog.service</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="referencias-6">Referencias:<a href="#referencias-6" class="hash-link" aria-label="Direct link to Referencias:" title="Direct link to Referencias:">​</a></h4>
<p>NIST SP 800-53 Rev. 5: AU-2, AU-3, AU-12</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="controles-cis-8">Controles CIS:<a href="#controles-cis-8" class="hash-link" aria-label="Direct link to Controles CIS:" title="Direct link to Controles CIS:">​</a></h2>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="mapeo-de-mitre-attck-3">Mapeo de MITRE ATT&amp;CK:<a href="#mapeo-de-mitre-attck-3" class="hash-link" aria-label="Direct link to Mapeo de MITRE ATT&amp;CK:" title="Direct link to Mapeo de MITRE ATT&amp;CK:">​</a></h2>
<table><thead><tr><th>Técnicas / Subtécnicas</th><th>Tácticas</th><th>Mitigaciones</th></tr></thead><tbody><tr><td>T1070, T1070.002, T1211, T1562, T1562.001</td><td>TA0005</td><td>M1029</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="6233-asegurar-que-journald-esté-configurado-para-enviar-registros-a-rsyslog-automatizado">6.2.3.3 Asegurar que journald esté configurado para enviar registros a rsyslog (Automatizado)<a href="#6233-asegurar-que-journald-esté-configurado-para-enviar-registros-a-rsyslog-automatizado" class="hash-link" aria-label="Direct link to 6.2.3.3 Asegurar que journald esté configurado para enviar registros a rsyslog (Automatizado)" title="Direct link to 6.2.3.3 Asegurar que journald esté configurado para enviar registros a rsyslog (Automatizado)">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="aplicabilidad-del-perfil-9">Aplicabilidad del perfil:<a href="#aplicabilidad-del-perfil-9" class="hash-link" aria-label="Direct link to Aplicabilidad del perfil:" title="Direct link to Aplicabilidad del perfil:">​</a></h4>
<ul>
<li>Nivel 1 - Servidor</li>
<li>Nivel 1 - Estación de trabajo</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="descripción-9">Descripción:<a href="#descripción-9" class="hash-link" aria-label="Direct link to Descripción:" title="Direct link to Descripción:">​</a></h4>
<p>Los datos de <strong>systemd-journald</strong> pueden almacenarse en memoria volátil o persistirse localmente en el servidor.<br>
<!-- -->Existen utilidades para aceptar la exportación remota de registros de <strong>systemd-journald</strong>, sin embargo,<br>
<!-- -->el uso del servicio <strong>rsyslog</strong> proporciona un medio consistente para la recopilación y exportación de registros.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="justificación-9">Justificación:<a href="#justificación-9" class="hash-link" aria-label="Direct link to Justificación:" title="Direct link to Justificación:">​</a></h4>
<ul>
<li><strong>SI</strong> <strong>rsyslog</strong> es el método preferido para capturar registros, todos los registros del sistema deben enviarse a él para su procesamiento adicional.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="impacto">Impacto:<a href="#impacto" class="hash-link" aria-label="Direct link to Impacto:" title="Direct link to Impacto:">​</a></h4>
<ul>
<li><strong>SI</strong> <strong>journald</strong> es el método preferido para capturar registros, esta sección y su recomendación deben omitirse,<br>
<!-- -->y en su lugar, debe seguirse la sección <strong>&quot;Configurar Journald&quot;</strong>.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="auditoría-9">Auditoría:<a href="#auditoría-9" class="hash-link" aria-label="Direct link to Auditoría:" title="Direct link to Auditoría:">​</a></h4>
<ul>
<li><strong>SI</strong> <strong>rsyslog</strong> es el método preferido para capturar registros:<br>
<!-- -->Ejecute el siguiente comando para verificar que los registros se están reenviando a <strong>rsyslog</strong>,<br>
<!-- -->configurando <strong>ForwardToSyslog</strong> en <strong>yes</strong> en la configuración de <strong>systemd-journald</strong>:</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># systemd-analyze cat-config systemd/journald.conf systemd/journald.conf.d/* \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  | grep -E &quot;^ForwardToSyslog=yes&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ForwardToSyslog=yes</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="remediación-7">Remediación:<a href="#remediación-7" class="hash-link" aria-label="Direct link to Remediación:" title="Direct link to Remediación:">​</a></h4>
<ul>
<li><strong>SI</strong> <strong><code>rsyslog</code></strong> es el método preferido para capturar registros:<br>
<!-- -->Establezca el siguiente parámetro en la sección <strong><code>[Journal]</code></strong> dentro de<br>
<code>/etc/systemd/journald.conf</code> o en un archivo dentro de <code>/etc/systemd/journald.conf.d/</code><br>
<!-- -->que termine en <code>.conf</code>:</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ForwardToSyslog=yes</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="ejemplo-2">Ejemplo<a href="#ejemplo-2" class="hash-link" aria-label="Direct link to Ejemplo" title="Direct link to Ejemplo">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#!/usr/bin/env bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [ ! -d /etc/systemd/journald.conf.d/ ] &amp;&amp; mkdir /etc/systemd/journald.conf.d/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if grep -Psq -- &#x27;^\h*\t*\[Journal\]&#x27; /etc/systemd/journald.conf.d/60-journald.conf; then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printf &#x27;%s\n&#x27; &quot;ForwardToSyslog=yes&quot; &gt;&gt; /etc/systemd/journald.conf.d/60-journald.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printf &#x27;%s\n&#x27; &quot;[Journal]&quot; &quot;ForwardToSyslog=yes&quot; &gt;&gt; /etc/systemd/journald.conf.d/60-journald.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>ℹ <strong>Nota:</strong>:
Si esta configuración aparece en un archivo posterior canónicamente o más adelante en el mismo archivo,<br>
<!-- -->la configuración será sobrescrita.</p>
</blockquote>
<p>Ejecute el siguiente comando para actualizar los parámetros en el servicio:<br>
<!-- -->Reinicie <strong>systemd-journald.service</strong>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># systemctl reload-or-restart systemd-journald.service</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="referencia-2">Referencia<a href="#referencia-2" class="hash-link" aria-label="Direct link to Referencia" title="Direct link to Referencia">​</a></h4>
<ol>
<li>NIST SP 800-53 Rev. 5: AC-3, AU-2, AU-4, AU-12, MP-2</li>
<li>SYSTEMD-JOURNALD.SERVICE(8)</li>
<li>JOURNALD.CONF(5)</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="información-adicional">Información adicional:<a href="#información-adicional" class="hash-link" aria-label="Direct link to Información adicional:" title="Direct link to Información adicional:">​</a></h2>
<p>Como se menciona en las páginas del manual de <strong>systemd-journald</strong>, los registros de <strong>systemd-journald</strong> pueden exportarse a <strong>rsyslog</strong> ya sea a través del proceso mencionado aquí o mediante una facilidad como <strong>systemd-journal.service</strong>. Existen compensaciones en cada implementación:</p>
<ul>
<li>
<p><strong>ForwardToSyslog</strong> capturará inmediatamente todos los eventos<br>
<!-- -->(y los reenviará a un servidor de registros externo si está configurado correctamente),<br>
<!-- -->pero <strong>puede no capturar todas las actividades de arranque</strong>.</p>
</li>
<li>
<p>Mecanismos como <strong>systemd-journal.service</strong>, en cambio,<br>
<!-- -->registrarán los eventos de arranque, pero pueden retrasar el envío de la información a <strong>rsyslog</strong>,<br>
<!-- -->lo que conlleva el <strong>riesgo de manipulación de registros antes de su exportación</strong>.</p>
</li>
</ul>
<p><strong>Es importante conocer las limitaciones de todas las herramientas empleadas para asegurar un sistema.</strong></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="controles-cis-9">Controles CIS:<a href="#controles-cis-9" class="hash-link" aria-label="Direct link to Controles CIS:" title="Direct link to Controles CIS:">​</a></h2>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="mapeo-de-mitre-attck-4">Mapeo de MITRE ATT&amp;CK:<a href="#mapeo-de-mitre-attck-4" class="hash-link" aria-label="Direct link to Mapeo de MITRE ATT&amp;CK:" title="Direct link to Mapeo de MITRE ATT&amp;CK:">​</a></h2>
<table><thead><tr><th>Técnicas / Subtécnicas</th><th>Tácticas</th><th>Mitigaciones</th></tr></thead><tbody><tr><td>T1070, T1070.002, T1562, T1562.006, T1565</td><td>TA0040</td><td>M1029</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="6234-asegurar-que-el-modo-de-creación-de-archivos-de-registro-de-rsyslog-esté-configurado-automatizado">6.2.3.4 Asegurar que el modo de creación de archivos de registro de rsyslog esté configurado (Automatizado)<a href="#6234-asegurar-que-el-modo-de-creación-de-archivos-de-registro-de-rsyslog-esté-configurado-automatizado" class="hash-link" aria-label="Direct link to 6.2.3.4 Asegurar que el modo de creación de archivos de registro de rsyslog esté configurado (Automatizado)" title="Direct link to 6.2.3.4 Asegurar que el modo de creación de archivos de registro de rsyslog esté configurado (Automatizado)">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="aplicabilidad-del-perfil-10">Aplicabilidad del Perfil:<a href="#aplicabilidad-del-perfil-10" class="hash-link" aria-label="Direct link to Aplicabilidad del Perfil:" title="Direct link to Aplicabilidad del Perfil:">​</a></h4>
<ul>
<li>Nivel 1 - Servidor</li>
<li>Nivel 1 - Estación de trabajo</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="descripción-10">Descripción:<a href="#descripción-10" class="hash-link" aria-label="Direct link to Descripción:" title="Direct link to Descripción:">​</a></h4>
<p><strong><code>rsyslog</code></strong> creará archivos de registro que no existen en el sistema.</p>
<p>El parámetro <strong><code>$FileCreateMode</code></strong> permite especificar el modo de creación con el cual <strong><code>rsyslog</code></strong> crea nuevos archivos.<br>
<!-- -->Si no se especifica, se usa el valor <code>0644</code> (que mantiene compatibilidad con versiones anteriores).<br>
<!-- -->El valor siempre debe ser un número octal de 4 dígitos, donde el primer dígito debe ser cero.</p>
<p>Tenga en cuenta que los permisos reales dependen de la umask del proceso de <strong><code>rsyslog</code></strong>.</p>
<p><strong><code>$FileCreateMode</code></strong> puede especificarse varias veces. Si es así, define el modo de creación<br>
<!-- -->para todos los selectores de registros que sigan hasta el próximo parámetro <strong><code>$FileCreateMode</code></strong>.<br>
<!-- -->El orden de las líneas es vitalmente importante.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="justificación-10">Justificación:<a href="#justificación-10" class="hash-link" aria-label="Direct link to Justificación:" title="Direct link to Justificación:">​</a></h4>
<p>Es importante asegurarse de que los archivos de registro tengan los permisos correctos<br>
<!-- -->para garantizar que los datos sensibles sean archivados y protegidos.</p>
<blockquote>
<p>ℹ <strong>Nota:</strong>:
Esta recomendación <strong>solo aplica si rsyslog es el método elegido para el registro de logs</strong>.<br>
<!-- -->No aplique esta recomendación si <strong><code>systemd-journald</code></strong> está en uso.</p>
</blockquote>
<hr>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="auditoría-10">Auditoría:<a href="#auditoría-10" class="hash-link" aria-label="Direct link to Auditoría:" title="Direct link to Auditoría:">​</a></h4>
<p>Ejecute el siguiente comando para verificar <strong><code>$FileCreateMode</code></strong>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># grep -Ps &#x27;^\h*\$FileCreateMode\h+[0,2,4,6][0,2,4,6][0,2,4,6][0,2,4,6]\b&#x27; /etc/rsyslog.conf /etc/rsyslog.d/*.conf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Verifique que la salida incluya 0640 o más restrictivos:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$FileCreateMode 0640</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Si una política del sitio dicta permisos menos restrictivos, asegúrese de cumplir dicha política.</p>
<blockquote>
<p>ℹ <strong>Nota:</strong>: Los permisos más restrictivos, como 0600, son implícitamente suficientes.</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="remediación-8">Remediación:<a href="#remediación-8" class="hash-link" aria-label="Direct link to Remediación:" title="Direct link to Remediación:">​</a></h2>
<p>Edite el archivo <strong>/etc/rsyslog.conf</strong> o un archivo <strong>.conf</strong> dedicado en <strong>/etc/rsyslog.d/</strong><br>
<!-- -->y configure <strong>$FileCreateMode</strong> a <strong>0640</strong> o un valor más restrictivo:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$FileCreateMode 0640</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Reiniciar el servicio:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># systemctl restart rsyslog</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="referencias-7">Referencias:<a href="#referencias-7" class="hash-link" aria-label="Direct link to Referencias:" title="Direct link to Referencias:">​</a></h4>
<ol>
<li>RSYSLOG.CONF(5)</li>
<li>NIST SP 800-53 Rev. 5: AC-3, AC-6, MP-2</li>
<li><a href="https://www.rsyslog.com/doc/" target="_blank" rel="noopener noreferrer">Documentación de Rsyslog</a></li>
<li><a href="https://www.rsyslog.com/doc/configuration/action/rsconf1_filecreatemode.html#filecreatemode" target="_blank" rel="noopener noreferrer">Configuración de $FileCreateMode en Rsyslog</a></li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="controles-cis-10">Controles CIS:<a href="#controles-cis-10" class="hash-link" aria-label="Direct link to Controles CIS:" title="Direct link to Controles CIS:">​</a></h2>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="mapeo-mitre-attck">Mapeo MITRE ATT&amp;CK:<a href="#mapeo-mitre-attck" class="hash-link" aria-label="Direct link to Mapeo MITRE ATT&amp;CK:" title="Direct link to Mapeo MITRE ATT&amp;CK:">​</a></h2>
<table><thead><tr><th>Técnicas / Subtécnicas</th><th>Tácticas</th><th>Mitigaciones</th></tr></thead><tbody><tr><td>T1070, T1070.002, T1083, T1083.000</td><td>TA0007</td><td>M1022</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="6235-asegurar-que-rsyslog-esté-configurado-manual">6.2.3.5 Asegurar que rsyslog esté configurado (Manual)<a href="#6235-asegurar-que-rsyslog-esté-configurado-manual" class="hash-link" aria-label="Direct link to 6.2.3.5 Asegurar que rsyslog esté configurado (Manual)" title="Direct link to 6.2.3.5 Asegurar que rsyslog esté configurado (Manual)">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="aplicabilidad-del-perfil-11">Aplicabilidad del Perfil:<a href="#aplicabilidad-del-perfil-11" class="hash-link" aria-label="Direct link to Aplicabilidad del Perfil:" title="Direct link to Aplicabilidad del Perfil:">​</a></h4>
<ul>
<li><strong>Nivel 1 - Servidor</strong></li>
<li><strong>Nivel 1 - Estación de trabajo</strong></li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="descripción-11">Descripción:<a href="#descripción-11" class="hash-link" aria-label="Direct link to Descripción:" title="Direct link to Descripción:">​</a></h4>
<p>Los archivos <code>/etc/rsyslog.conf</code> y <code>/etc/rsyslog.d/*.conf</code> especifican reglas para el registro de eventos y qué archivos se utilizarán para registrar ciertas clases de mensajes.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="justificación-11">Justificación:<a href="#justificación-11" class="hash-link" aria-label="Direct link to Justificación:" title="Direct link to Justificación:">​</a></h4>
<p>Mucha información crítica relacionada con la seguridad se envía a través de <strong>rsyslog</strong>
(por ejemplo, intentos de <code>su</code> exitosos y fallidos, intentos de inicio de sesión fallidos, intentos de inicio de sesión como root, etc.).</p>
<blockquote>
<p>ℹ <strong>Nota:</strong>: Esta recomendación solo aplica si <strong>rsyslog</strong> es el método elegido para el registro del lado del cliente.<br>
<!-- -->No aplicar esta recomendación si <strong>journald</strong> está en uso.</p>
</blockquote>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="auditoría-11">Auditoría:<a href="#auditoría-11" class="hash-link" aria-label="Direct link to Auditoría:" title="Direct link to Auditoría:">​</a></h4>
<ol>
<li>Revisar el contenido de los archivos de configuración:<!-- -->
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /etc/rsyslog.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat /etc/rsyslog.d/*.conf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="remediación-9">Remediación:<a href="#remediación-9" class="hash-link" aria-label="Direct link to Remediación:" title="Direct link to Remediación:">​</a></h4>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="edición-de-archivos-de-configuración">Edición de archivos de configuración<a href="#edición-de-archivos-de-configuración" class="hash-link" aria-label="Direct link to Edición de archivos de configuración" title="Direct link to Edición de archivos de configuración">​</a></h3>
<p>Edite las siguientes líneas en los archivos:</p>
<ul>
<li><code>/etc/rsyslog.conf</code></li>
<li><code>/etc/rsyslog.d/*.conf</code></li>
</ul>
<p>según corresponda a su entorno.</p>
<blockquote>
<p>ℹ <strong>Nota:</strong>: La configuración a continuación se proporciona solo con fines ilustrativos. Se debe considerar cuidadosamente cómo la organización desea almacenar los datos de registro.</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ejemplo-de-configuración">Ejemplo de configuración:<a href="#ejemplo-de-configuración" class="hash-link" aria-label="Direct link to Ejemplo de configuración:" title="Direct link to Ejemplo de configuración:">​</a></h3>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">*.emerg                         :omusrmsg:*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth,authpriv.*                  /var/log/secure</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mail.*                           -/var/log/mail</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mail.info                        -/var/log/mail.info</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mail.warning                     -/var/log/mail.warn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mail.err                         -/var/log/mail.err</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cron.*                           /var/log/cron</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*.warning;*.=err                 -/var/log/warn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*.crit                           -/var/log/warn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*.*;mail.none;news.none          -/var/log/messages</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">local0,local1.*                  -/var/log/localmessages</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">local2,local3.*                  -/var/log/localmessages</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">local4,local5.*                  -/var/log/localmessages</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">local6,local7.*                  -/var/log/localmessages</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Ejecute el siguiente comando para recargar la configuración de <code>rsyslogd</code>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># systemctl restart rsyslog</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="referencias-8">Referencias:<a href="#referencias-8" class="hash-link" aria-label="Direct link to Referencias:" title="Direct link to Referencias:">​</a></h4>
<ol>
<li>Consulte la página de manual <code>rsyslog.conf(5)</code> para obtener más información.</li>
<li>NIST SP 800-53 Rev. 5: AU-2, AU-7, AU-12</li>
</ol>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="controles-cis-11">Controles CIS:<a href="#controles-cis-11" class="hash-link" aria-label="Direct link to Controles CIS:" title="Direct link to Controles CIS:">​</a></h2>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="mapeos-de-mitre-attck">Mapeos de MITRE ATT&amp;CK:<a href="#mapeos-de-mitre-attck" class="hash-link" aria-label="Direct link to Mapeos de MITRE ATT&amp;CK:" title="Direct link to Mapeos de MITRE ATT&amp;CK:">​</a></h2>
<table><thead><tr><th>Técnicas / Subtécnicas</th><th>Tácticas</th><th>Mitigaciones</th></tr></thead><tbody><tr><td>T1070, T1070.002</td><td>TA0005</td><td>M1047</td></tr></tbody></table>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="6236-asegurar-que-rsyslog-esté-configurado-para-enviar-registros-a-un-host-de-registro-remoto-manual">6.2.3.6 Asegurar que rsyslog esté configurado para enviar registros a un host de registro remoto (Manual)<a href="#6236-asegurar-que-rsyslog-esté-configurado-para-enviar-registros-a-un-host-de-registro-remoto-manual" class="hash-link" aria-label="Direct link to 6.2.3.6 Asegurar que rsyslog esté configurado para enviar registros a un host de registro remoto (Manual)" title="Direct link to 6.2.3.6 Asegurar que rsyslog esté configurado para enviar registros a un host de registro remoto (Manual)">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="aplicabilidad-del-perfil-12">Aplicabilidad del Perfil:<a href="#aplicabilidad-del-perfil-12" class="hash-link" aria-label="Direct link to Aplicabilidad del Perfil:" title="Direct link to Aplicabilidad del Perfil:">​</a></h4>
<ul>
<li><strong>Nivel 1 - Servidor</strong></li>
<li><strong>Nivel 1 - Estación de trabajo</strong></li>
</ul>
<hr>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="descripción-12">Descripción:<a href="#descripción-12" class="hash-link" aria-label="Direct link to Descripción:" title="Direct link to Descripción:">​</a></h4>
<p><code>rsyslog</code> admite la capacidad de enviar eventos de registro que recopila a un host de registro remoto o recibir mensajes de hosts remotos, lo que permite la gestión centralizada de registros.</p>
<hr>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="justificación-12">Justificación:<a href="#justificación-12" class="hash-link" aria-label="Direct link to Justificación:" title="Direct link to Justificación:">​</a></h4>
<p>Almacenar datos de registro en un host remoto protege la integridad de los registros frente a ataques locales. Si un atacante obtiene acceso root en el sistema local, podría manipular o eliminar los datos de registro almacenados en el sistema local.</p>
<hr>
<blockquote>
<p>ℹ <strong>Nota:</strong> Esta recomendación solo se aplica si <code>rsyslog</code> es el método elegido para el registro del lado del cliente. No aplique esta recomendación si se usa <code>systemd-journald</code>.</p>
</blockquote>
<hr>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="auditoría-12">Auditoría:<a href="#auditoría-12" class="hash-link" aria-label="Direct link to Auditoría:" title="Direct link to Auditoría:">​</a></h4>
<p>Revisar los archivos <code>/etc/rsyslog.conf</code> y <code>/etc/rsyslog.d/*.conf</code> y verificar que los registros se envíen a un host central:</p>
<blockquote>
<p>ℹ <strong>Nota:</strong>: El <strong>formato básico</strong> está destinado a usuarios que configuraron su archivo utilizando <code>@loghost.example.com</code>.<br>
<!-- -->El <strong>formato avanzado</strong> es un formato más moderno que auditará el formato de manera similar a la utilizada en la remediación.</p>
</blockquote>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="formato-básico">Formato básico:<a href="#formato-básico" class="hash-link" aria-label="Direct link to Formato básico:" title="Direct link to Formato básico:">​</a></h4>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">grep &quot;^*.*[^1][^I]*@&quot; /etc/rsyslog.conf /etc/rsyslog.d/*.conf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>La salida debe incluir <code>@@&lt;FQDN o IP del loghost remoto&gt;</code>:</p>
<p><strong>Ejemplo:</strong></p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">*.* @@loghost.example.com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="formato-avanzado">formato avanzado<a href="#formato-avanzado" class="hash-link" aria-label="Direct link to formato avanzado" title="Direct link to formato avanzado">​</a></h4>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># grep -Psi -- &#x27;^\s*([^#]+\s+)?action\(([^#]+\s+)?\btarget=\&quot;?[^#&quot;]+\&quot;?\b&#x27; /etc/rsyslog.conf /etc/rsyslog.d/*.conf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>La salida debe incluir <code>target=&lt;FQDN or IP of remote loghost&gt;</code>:</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="ejemplo-3">Ejemplo:<a href="#ejemplo-3" class="hash-link" aria-label="Direct link to Ejemplo:" title="Direct link to Ejemplo:">​</a></h4>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">*.* action(type=&quot;omfwd&quot; target=&quot;loghost.example.com&quot; port=&quot;514&quot; protocol=&quot;tcp&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="remediación-10">Remediación:<a href="#remediación-10" class="hash-link" aria-label="Direct link to Remediación:" title="Direct link to Remediación:">​</a></h4>
<p>Edite los archivos <code>/etc/rsyslog.conf</code> y <code>/etc/rsyslog.d/*.conf</code> y agregue la siguiente línea (donde loghost.example.com es el nombre de su host de registro central). El <code>target</code> de destino puede ser un nombre de dominio completo o una dirección IP.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="ejemplo-4">Ejemplo:<a href="#ejemplo-4" class="hash-link" aria-label="Direct link to Ejemplo:" title="Direct link to Ejemplo:">​</a></h4></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/documentacion/ejemplos/6.2.2.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/hardening/docs/documentacion/ejemplos/6.2.1.4"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">6.2.1.4 Asegurarse de que solo se use un sistema de registro (Automatizado)</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#6221-configurar-systemd-journal-remote" class="table-of-contents__link toc-highlight">6.2.2.1 Configurar <code>systemd-journal-remote</code></a><ul><li><a href="#6221-asegurar-que-systemd-journal-remote-esté-instalado-automatizado" class="table-of-contents__link toc-highlight">6.2.2.1 Asegurar que systemd-journal-remote esté instalado (Automatizado)</a></li></ul></li><li><a href="#controles-cis" class="table-of-contents__link toc-highlight">Controles CIS:</a></li><li><a href="#62212-asegurar-que-la-autenticación-de-systemd-journal-upload-esté-configurada-manual" class="table-of-contents__link toc-highlight">6.2.2.1.2 Asegurar que la autenticación de systemd-journal-upload esté configurada (Manual)</a><ul><li><a href="#aplicabilidad-del-perfil-1" class="table-of-contents__link toc-highlight">Aplicabilidad del perfil:</a></li><li><a href="#descripción-1" class="table-of-contents__link toc-highlight">Descripción:</a></li><li><a href="#justificación-1" class="table-of-contents__link toc-highlight">Justificación:</a></li><li><a href="#auditoría-1" class="table-of-contents__link toc-highlight">Auditoría:</a></li><li><a href="#remediación-1" class="table-of-contents__link toc-highlight">Remediación:</a></li><li><a href="#referencias-1" class="table-of-contents__link toc-highlight">Referencias</a></li></ul></li><li><a href="#controles-cis-1" class="table-of-contents__link toc-highlight">Controles CIS:</a><ul><li><a href="#62213-asegurar-que-systemd-journal-upload-esté-habilitado-y-activo-automatizado" class="table-of-contents__link toc-highlight">6.2.2.1.3 Asegurar que systemd-journal-upload esté habilitado y activo (Automatizado)</a></li></ul></li><li><a href="#controles-cis-2" class="table-of-contents__link toc-highlight">Controles CIS:</a><ul><li><a href="#62214-asegurar-que-el-servicio-systemd-journal-remote-no-esté-en-uso-automatizado" class="table-of-contents__link toc-highlight">6.2.2.1.4 Asegurar que el servicio systemd-journal-remote no esté en uso (Automatizado)</a></li></ul></li><li><a href="#controles-cis-3" class="table-of-contents__link toc-highlight">Controles CIS:</a><ul><li><a href="#6222-asegurar-que-forwardtosyslog-de-journald-esté-deshabilitado-automatizado" class="table-of-contents__link toc-highlight">6.2.2.2 Asegurar que ForwardToSyslog de journald esté deshabilitado (Automatizado)</a></li></ul></li><li><a href="#controles-cis-4" class="table-of-contents__link toc-highlight">Controles CIS:</a><ul><li><a href="#6223-asegurar-que-journald-compress-esté-configurado-automatizado" class="table-of-contents__link toc-highlight">6.2.2.3 Asegurar que journald Compress esté configurado (Automatizado)</a></li></ul></li><li><a href="#controles-cis-5" class="table-of-contents__link toc-highlight">Controles CIS:</a></li><li><a href="#mapeo-de-mitre-attck" class="table-of-contents__link toc-highlight">Mapeo de MITRE ATT&amp;CK:</a><ul><li><a href="#6224-asegurar-que-journald-storage-esté-configurado-automatizado" class="table-of-contents__link toc-highlight">6.2.2.4 Asegurar que journald Storage esté configurado (Automatizado)</a></li></ul></li><li><a href="#controles-cis-6" class="table-of-contents__link toc-highlight">Controles CIS:</a></li><li><a href="#mapeo-de-mitre-attck-1" class="table-of-contents__link toc-highlight">Mapeo de MITRE ATT&amp;CK:</a></li><li><a href="#623-configurar-rsyslog" class="table-of-contents__link toc-highlight">6.2.3 Configurar rsyslog</a><ul><li><a href="#6231-asegurar-que-rsyslog-esté-instalado-automatizado" class="table-of-contents__link toc-highlight">6.2.3.1 Asegurar que rsyslog esté instalado (Automatizado)</a></li></ul></li><li><a href="#controles-cis-7" class="table-of-contents__link toc-highlight">Controles CIS:</a></li><li><a href="#mapeo-de-mitre-attck-2" class="table-of-contents__link toc-highlight">Mapeo de MITRE ATT&amp;CK:</a><ul><li><a href="#6232-asegurar-que-el-servicio-rsyslog-esté-habilitado-y-activo-automatizado" class="table-of-contents__link toc-highlight">6.2.3.2 Asegurar que el servicio rsyslog esté habilitado y activo (Automatizado)</a></li></ul></li><li><a href="#controles-cis-8" class="table-of-contents__link toc-highlight">Controles CIS:</a></li><li><a href="#mapeo-de-mitre-attck-3" class="table-of-contents__link toc-highlight">Mapeo de MITRE ATT&amp;CK:</a><ul><li><a href="#6233-asegurar-que-journald-esté-configurado-para-enviar-registros-a-rsyslog-automatizado" class="table-of-contents__link toc-highlight">6.2.3.3 Asegurar que journald esté configurado para enviar registros a rsyslog (Automatizado)</a></li></ul></li><li><a href="#información-adicional" class="table-of-contents__link toc-highlight">Información adicional:</a></li><li><a href="#controles-cis-9" class="table-of-contents__link toc-highlight">Controles CIS:</a></li><li><a href="#mapeo-de-mitre-attck-4" class="table-of-contents__link toc-highlight">Mapeo de MITRE ATT&amp;CK:</a><ul><li><a href="#6234-asegurar-que-el-modo-de-creación-de-archivos-de-registro-de-rsyslog-esté-configurado-automatizado" class="table-of-contents__link toc-highlight">6.2.3.4 Asegurar que el modo de creación de archivos de registro de rsyslog esté configurado (Automatizado)</a></li></ul></li><li><a href="#remediación-8" class="table-of-contents__link toc-highlight">Remediación:</a></li><li><a href="#controles-cis-10" class="table-of-contents__link toc-highlight">Controles CIS:</a></li><li><a href="#mapeo-mitre-attck" class="table-of-contents__link toc-highlight">Mapeo MITRE ATT&amp;CK:</a><ul><li><a href="#6235-asegurar-que-rsyslog-esté-configurado-manual" class="table-of-contents__link toc-highlight">6.2.3.5 Asegurar que rsyslog esté configurado (Manual)</a></li><li><a href="#edición-de-archivos-de-configuración" class="table-of-contents__link toc-highlight">Edición de archivos de configuración</a></li><li><a href="#ejemplo-de-configuración" class="table-of-contents__link toc-highlight">Ejemplo de configuración:</a></li></ul></li><li><a href="#controles-cis-11" class="table-of-contents__link toc-highlight">Controles CIS:</a></li><li><a href="#mapeos-de-mitre-attck" class="table-of-contents__link toc-highlight">Mapeos de MITRE ATT&amp;CK:</a><ul><li><a href="#6236-asegurar-que-rsyslog-esté-configurado-para-enviar-registros-a-un-host-de-registro-remoto-manual" class="table-of-contents__link toc-highlight">6.2.3.6 Asegurar que rsyslog esté configurado para enviar registros a un host de registro remoto (Manual)</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Puntos de Hardening</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/hardening/docs/documentacion/ejemplos/ejemplo1">RHEL 9.0</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.cisecurity.org/benchmark/red_hat_linux" target="_blank" rel="noopener noreferrer" class="footer__link-item">CIS Benchmarks<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/LuisEAlmeida/hardening" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Conoce más</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/hardening/blog">Blog</a></li></ul></div></div></div></footer></div>
</body>
</html>