"use strict";(self.webpackChunkhardening=self.webpackChunkhardening||[]).push([[8767],{3428:(e,s,i)=>{i.r(s),i.d(s,{assets:()=>o,contentTitle:()=>d,default:()=>u,frontMatter:()=>l,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"documentacion/ejemplos/6.2.2","title":"6.2.2 Configurar journald","description":"El paquete systemd incluye un servicio de registro llamado systemd-journald.service para la recopilaci\xf3n y almacenamiento de datos de registro. Este servicio crea y mantiene diarios estructurados e indexados basados en informaci\xf3n de registro proveniente de diversas fuentes, tales como:","source":"@site/docs/documentacion/ejemplos/6.2.2.md","sourceDirName":"documentacion/ejemplos","slug":"/documentacion/ejemplos/6.2.2","permalink":"/hardening/docs/documentacion/ejemplos/6.2.2","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/documentacion/ejemplos/6.2.2.md","tags":[],"version":"current","frontMatter":{},"sidebar":"documentacionSidebar","previous":{"title":"6.2.1.4 Asegurarse de que solo se use un sistema de registro (Automatizado)","permalink":"/hardening/docs/documentacion/ejemplos/6.2.1.4"}}');var n=i(4848),a=i(8453);const l={},d="6.2.2 Configurar journald",o={},c=[{value:"6.2.2.1 Configurar <code>systemd-journal-remote</code>",id:"6221-configurar-systemd-journal-remote",level:2},{value:"6.2.2.1 Asegurar que systemd-journal-remote est\xe9 instalado (Automatizado)",id:"6221-asegurar-que-systemd-journal-remote-est\xe9-instalado-automatizado",level:3},{value:"Aplicabilidad del perfil:",id:"aplicabilidad-del-perfil",level:4},{value:"Descripci\xf3n:",id:"descripci\xf3n",level:4},{value:"Justificaci\xf3n:",id:"justificaci\xf3n",level:4},{value:"Auditor\xeda:",id:"auditor\xeda",level:4},{value:"Remediaci\xf3n:",id:"remediaci\xf3n",level:4},{value:"Referencias:",id:"referencias",level:4},{value:"Controles CIS:",id:"controles-cis",level:2},{value:"6.2.2.1.2 Asegurar que la autenticaci\xf3n de systemd-journal-upload est\xe9 configurada (Manual)",id:"62212-asegurar-que-la-autenticaci\xf3n-de-systemd-journal-upload-est\xe9-configurada-manual",level:2},{value:"Aplicabilidad del perfil:",id:"aplicabilidad-del-perfil-1",level:3},{value:"Descripci\xf3n:",id:"descripci\xf3n-1",level:3},{value:"Justificaci\xf3n:",id:"justificaci\xf3n-1",level:3},{value:"Auditor\xeda:",id:"auditor\xeda-1",level:3},{value:"Remediaci\xf3n:",id:"remediaci\xf3n-1",level:3},{value:"Referencias",id:"referencias-1",level:3},{value:"Controles CIS:",id:"controles-cis-1",level:2},{value:"6.2.2.1.3 Asegurar que systemd-journal-upload est\xe9 habilitado y activo (Automatizado)",id:"62213-asegurar-que-systemd-journal-upload-est\xe9-habilitado-y-activo-automatizado",level:3},{value:"Aplicabilidad del perfil:",id:"aplicabilidad-del-perfil-2",level:4},{value:"Descripci\xf3n:",id:"descripci\xf3n-2",level:4},{value:"Justificaci\xf3n:",id:"justificaci\xf3n-2",level:4},{value:"Auditor\xeda:",id:"auditor\xeda-2",level:4},{value:"Remediaci\xf3n:",id:"remediaci\xf3n-2",level:4},{value:"Referencia:",id:"referencia",level:4},{value:"Controles CIS:",id:"controles-cis-2",level:2},{value:"6.2.2.1.4 Asegurar que el servicio systemd-journal-remote no est\xe9 en uso (Automatizado)",id:"62214-asegurar-que-el-servicio-systemd-journal-remote-no-est\xe9-en-uso-automatizado",level:3},{value:"Aplicabilidad del perfil:",id:"aplicabilidad-del-perfil-3",level:4},{value:"Descripci\xf3n:",id:"descripci\xf3n-3",level:4},{value:"Justificaci\xf3n:",id:"justificaci\xf3n-3",level:4},{value:"Auditor\xeda:",id:"auditor\xeda-3",level:4},{value:"Reneduaci\xf3n",id:"reneduaci\xf3n",level:4},{value:"Referencias:",id:"referencias-2",level:4},{value:"Controles CIS:",id:"controles-cis-3",level:2},{value:"6.2.2.2 Asegurar que ForwardToSyslog de journald est\xe9 deshabilitado (Automatizado)",id:"6222-asegurar-que-forwardtosyslog-de-journald-est\xe9-deshabilitado-automatizado",level:3},{value:"Aplicabilidad del perfil:",id:"aplicabilidad-del-perfil-4",level:4},{value:"Descripci\xf3n:",id:"descripci\xf3n-4",level:4},{value:"Justificaci\xf3n:",id:"justificaci\xf3n-4",level:4},{value:"Auditor\xeda:",id:"auditor\xeda-4",level:4},{value:"Remediaci\xf3n:",id:"remediaci\xf3n-3",level:4},{value:"Referencias:",id:"referencias-3",level:4},{value:"Controles CIS:",id:"controles-cis-4",level:2},{value:"6.2.2.3 Asegurar que journald Compress est\xe9 configurado (Automatizado)",id:"6223-asegurar-que-journald-compress-est\xe9-configurado-automatizado",level:3},{value:"Aplicabilidad del perfil:",id:"aplicabilidad-del-perfil-5",level:4},{value:"Descripci\xf3n:",id:"descripci\xf3n-5",level:4},{value:"Justificaci\xf3n:",id:"justificaci\xf3n-5",level:4},{value:"Auditor\xeda:",id:"auditor\xeda-5",level:4},{value:"Remediaci\xf3n:",id:"remediaci\xf3n-4",level:4},{value:"Ejemplo:",id:"ejemplo",level:4},{value:"Referencias",id:"referencias-4",level:4},{value:"Controles CIS:",id:"controles-cis-5",level:2},{value:"Mapeo de MITRE ATT&amp;CK:",id:"mapeo-de-mitre-attck",level:2},{value:"6.2.2.4 Asegurar que journald Storage est\xe9 configurado (Automatizado)",id:"6224-asegurar-que-journald-storage-est\xe9-configurado-automatizado",level:3},{value:"Aplicabilidad del perfil:",id:"aplicabilidad-del-perfil-6",level:4},{value:"Descripci\xf3n:",id:"descripci\xf3n-6",level:4},{value:"Justificaci\xf3n:",id:"justificaci\xf3n-6",level:4},{value:"Auditor\xeda:",id:"auditor\xeda-6",level:4},{value:"Remediaci\xf3n:",id:"remediaci\xf3n-5",level:4},{value:"Ejemplo:",id:"ejemplo-1",level:4},{value:"Referencia",id:"referencia-1",level:4},{value:"Controles CIS:",id:"controles-cis-6",level:2},{value:"Mapeo de MITRE ATT&amp;CK:",id:"mapeo-de-mitre-attck-1",level:2},{value:"6.2.3 Configurar rsyslog",id:"623-configurar-rsyslog",level:2},{value:"6.2.3.1 Asegurar que rsyslog est\xe9 instalado (Automatizado)",id:"6231-asegurar-que-rsyslog-est\xe9-instalado-automatizado",level:3},{value:"Aplicabilidad del perfil:",id:"aplicabilidad-del-perfil-7",level:4},{value:"Descripci\xf3n:",id:"descripci\xf3n-7",level:4},{value:"Justificaci\xf3n:",id:"justificaci\xf3n-7",level:4},{value:"Auditor\xeda:",id:"auditor\xeda-7",level:4},{value:"Recomendaci\xf3n:",id:"recomendaci\xf3n",level:4},{value:"Valor predeterminado:",id:"valor-predeterminado",level:4},{value:"Referencias:",id:"referencias-5",level:4},{value:"Controles CIS:",id:"controles-cis-7",level:2},{value:"Mapeo de MITRE ATT&amp;CK:",id:"mapeo-de-mitre-attck-2",level:2},{value:"6.2.3.2 Asegurar que el servicio rsyslog est\xe9 habilitado y activo (Automatizado)",id:"6232-asegurar-que-el-servicio-rsyslog-est\xe9-habilitado-y-activo-automatizado",level:3},{value:"Aplicabilidad del perfil:",id:"aplicabilidad-del-perfil-8",level:4},{value:"Descripci\xf3n:",id:"descripci\xf3n-8",level:4},{value:"Justificaci\xf3n:",id:"justificaci\xf3n-8",level:4},{value:"Auditor\xeda:",id:"auditor\xeda-8",level:4},{value:"Remediaci\xf3n:",id:"remediaci\xf3n-6",level:4},{value:"Referencias:",id:"referencias-6",level:4},{value:"Controles CIS:",id:"controles-cis-8",level:2},{value:"Mapeo de MITRE ATT&amp;CK:",id:"mapeo-de-mitre-attck-3",level:2},{value:"6.2.3.3 Asegurar que journald est\xe9 configurado para enviar registros a rsyslog (Automatizado)",id:"6233-asegurar-que-journald-est\xe9-configurado-para-enviar-registros-a-rsyslog-automatizado",level:3},{value:"Aplicabilidad del perfil:",id:"aplicabilidad-del-perfil-9",level:4},{value:"Descripci\xf3n:",id:"descripci\xf3n-9",level:4},{value:"Justificaci\xf3n:",id:"justificaci\xf3n-9",level:4},{value:"Impacto:",id:"impacto",level:4},{value:"Auditor\xeda:",id:"auditor\xeda-9",level:4},{value:"Remediaci\xf3n:",id:"remediaci\xf3n-7",level:4},{value:"Ejemplo",id:"ejemplo-2",level:4},{value:"Referencia",id:"referencia-2",level:4},{value:"Informaci\xf3n adicional:",id:"informaci\xf3n-adicional",level:2},{value:"Controles CIS:",id:"controles-cis-9",level:2},{value:"Mapeo de MITRE ATT&amp;CK:",id:"mapeo-de-mitre-attck-4",level:2},{value:"6.2.3.4 Asegurar que el modo de creaci\xf3n de archivos de registro de rsyslog est\xe9 configurado (Automatizado)",id:"6234-asegurar-que-el-modo-de-creaci\xf3n-de-archivos-de-registro-de-rsyslog-est\xe9-configurado-automatizado",level:3},{value:"Aplicabilidad del Perfil:",id:"aplicabilidad-del-perfil-10",level:4},{value:"Descripci\xf3n:",id:"descripci\xf3n-10",level:4},{value:"Justificaci\xf3n:",id:"justificaci\xf3n-10",level:4},{value:"Auditor\xeda:",id:"auditor\xeda-10",level:4},{value:"Remediaci\xf3n:",id:"remediaci\xf3n-8",level:2},{value:"Referencias:",id:"referencias-7",level:4},{value:"Controles CIS:",id:"controles-cis-10",level:2},{value:"Mapeo MITRE ATT&amp;CK:",id:"mapeo-mitre-attck",level:2},{value:"6.2.3.5 Asegurar que rsyslog est\xe9 configurado (Manual)",id:"6235-asegurar-que-rsyslog-est\xe9-configurado-manual",level:3},{value:"Aplicabilidad del Perfil:",id:"aplicabilidad-del-perfil-11",level:4},{value:"Descripci\xf3n:",id:"descripci\xf3n-11",level:4},{value:"Justificaci\xf3n:",id:"justificaci\xf3n-11",level:4},{value:"Auditor\xeda:",id:"auditor\xeda-11",level:4},{value:"Remediaci\xf3n:",id:"remediaci\xf3n-9",level:4},{value:"Edici\xf3n de archivos de configuraci\xf3n",id:"edici\xf3n-de-archivos-de-configuraci\xf3n",level:3},{value:"Ejemplo de configuraci\xf3n:",id:"ejemplo-de-configuraci\xf3n",level:3},{value:"Referencias:",id:"referencias-8",level:4},{value:"Controles CIS:",id:"controles-cis-11",level:2},{value:"Mapeos de MITRE ATT&amp;CK:",id:"mapeos-de-mitre-attck",level:2},{value:"6.2.3.6 Asegurar que rsyslog est\xe9 configurado para enviar registros a un host de registro remoto (Manual)",id:"6236-asegurar-que-rsyslog-est\xe9-configurado-para-enviar-registros-a-un-host-de-registro-remoto-manual",level:3},{value:"Aplicabilidad del Perfil:",id:"aplicabilidad-del-perfil-12",level:4},{value:"Descripci\xf3n:",id:"descripci\xf3n-12",level:4},{value:"Justificaci\xf3n:",id:"justificaci\xf3n-12",level:4},{value:"Auditor\xeda:",id:"auditor\xeda-12",level:4},{value:"Formato b\xe1sico:",id:"formato-b\xe1sico",level:4},{value:"formato avanzado",id:"formato-avanzado",level:4},{value:"Ejemplo:",id:"ejemplo-3",level:4},{value:"Remediaci\xf3n:",id:"remediaci\xf3n-10",level:4},{value:"Ejemplo:",id:"ejemplo-4",level:4}];function t(e){const s={a:"a",blockquote:"blockquote",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.header,{children:(0,n.jsx)(s.h1,{id:"622-configurar-journald",children:"6.2.2 Configurar journald"})}),"\n",(0,n.jsxs)(s.p,{children:["El paquete ",(0,n.jsx)(s.code,{children:"systemd"})," incluye un servicio de registro llamado systemd-journald.service para la recopilaci\xf3n y almacenamiento de datos de registro. Este servicio crea y mantiene ",(0,n.jsx)(s.strong,{children:"diarios estructurados e indexados"})," basados en informaci\xf3n de registro proveniente de diversas fuentes, tales como:"]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"Registros cl\xe1sicos RFC3164 BSD syslog"})," a trav\xe9s del socket ",(0,n.jsx)(s.code,{children:"/dev/log"}),"."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"STDOUT/STDERR de programas"})," mediante ",(0,n.jsx)(s.code,{children:"StandardOutput=journal"})," y ",(0,n.jsx)(s.code,{children:"StandardError=journal"})," en archivos de servicio (ambos son configuraciones predeterminadas)."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"Mensajes del kernel"})," a trav\xe9s del nodo de dispositivo ",(0,n.jsx)(s.code,{children:"/dev/kmsg"}),"."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"Registros de auditor\xeda"})," mediante el subsistema de auditor\xeda del kernel."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"Mensajes de registro estructurados"})," a trav\xe9s del protocolo nativo de ",(0,n.jsx)(s.code,{children:"journald"}),"."]}),"\n"]}),"\n",(0,n.jsxs)(s.p,{children:["Cualquier cambio realizado en la configuraci\xf3n de ",(0,n.jsx)(s.code,{children:"systemd-journald"})," requerir\xe1 un reinicio del servicio."]}),"\n",(0,n.jsxs)(s.blockquote,{children:["\n",(0,n.jsxs)(s.p,{children:["\u2139 ",(0,n.jsx)(s.strong,{children:"Nota:"})]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"IF"})," - Si se utilizar\xe1 ",(0,n.jsx)(s.code,{children:"rsyslog"})," para el registro remoto en el sistema, esta subsecci\xf3n puede omitirse."]}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(s.h2,{id:"6221-configurar-systemd-journal-remote",children:["6.2.2.1 Configurar ",(0,n.jsx)(s.code,{children:"systemd-journal-remote"})]}),"\n",(0,n.jsxs)(s.p,{children:["El paquete ",(0,n.jsx)(s.code,{children:"systemd-journal-remote"})," incluye ",(0,n.jsx)(s.code,{children:"systemd-journal-upload"}),"."]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.code,{children:"systemd-journal-upload"})," cargar\xe1 las entradas del diario a la URL especificada con ",(0,n.jsx)(s.code,{children:"--url="}),".",(0,n.jsx)(s.br,{}),"\n","Este programa lee entradas del diario desde uno o m\xe1s archivos de registro, de manera similar a ",(0,n.jsx)(s.code,{children:"journalctl"}),"."]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.code,{children:"systemd-journal-upload"})," transfiere el contenido sin procesar de los archivos del diario y utiliza ",(0,n.jsx)(s.strong,{children:"HTTP"})," como protocolo de transporte."]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.code,{children:"systemd-journal-upload.service"})," es un servicio del sistema que usa ",(0,n.jsx)(s.code,{children:"systemd-journal-upload"})," para cargar entradas del diario a un servidor.",(0,n.jsx)(s.br,{}),"\n","Utiliza la configuraci\xf3n definida en ",(0,n.jsx)(s.code,{children:"journal-upload.conf"}),"."]}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(s.blockquote,{children:["\n",(0,n.jsxs)(s.p,{children:["\u2139 ",(0,n.jsx)(s.strong,{children:"Nota:"})]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"IF"})," - Si ",(0,n.jsx)(s.code,{children:"rsyslog"})," est\xe1 en uso, esta subsecci\xf3n puede omitirse."]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(s.h3,{id:"6221-asegurar-que-systemd-journal-remote-est\xe9-instalado-automatizado",children:"6.2.2.1 Asegurar que systemd-journal-remote est\xe9 instalado (Automatizado)"}),"\n",(0,n.jsx)(s.h4,{id:"aplicabilidad-del-perfil",children:"Aplicabilidad del perfil:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"Nivel 1 - Servidor"}),"\n",(0,n.jsx)(s.li,{children:"Nivel 1 - Estaci\xf3n de trabajo"}),"\n"]}),"\n",(0,n.jsx)(s.h4,{id:"descripci\xf3n",children:"Descripci\xf3n:"}),"\n",(0,n.jsxs)(s.p,{children:["Journal ",(0,n.jsx)(s.strong,{children:"systemd-journal-remote"})," admite la capacidad de enviar eventos de registro que recopila a un host de registro remoto o recibir mensajes de hosts remotos, lo que permite la gesti\xf3n centralizada de registros."]}),"\n",(0,n.jsx)(s.h4,{id:"justificaci\xf3n",children:"Justificaci\xf3n:"}),"\n",(0,n.jsx)(s.p,{children:"Almacenar datos de registro en un host remoto protege la integridad de los registros contra ataques locales. Si un atacante obtiene acceso root en el sistema local, podr\xeda manipular o eliminar datos de registro almacenados en el sistema local."}),"\n",(0,n.jsxs)(s.blockquote,{children:["\n",(0,n.jsxs)(s.p,{children:["\u2139 ",(0,n.jsx)(s.strong,{children:"Nota:"})," Esta recomendaci\xf3n ",(0,n.jsx)(s.strong,{children:"solo aplica si journald es el m\xe9todo elegido para el registro del cliente"}),". No aplique esta recomendaci\xf3n si se utiliza ",(0,n.jsx)(s.strong,{children:"rsyslog"}),"."]}),"\n"]}),"\n",(0,n.jsx)(s.h4,{id:"auditor\xeda",children:"Auditor\xeda:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"SI"})," se utilizar\xe1 ",(0,n.jsx)(s.code,{children:"journald"})," para el registro en el sistema:\r\nEjecute el siguiente comando para verificar que ",(0,n.jsx)(s.strong,{children:"systemd-journal-remote"})," est\xe1 instalado:"]}),"\n"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"rpm -q systemd-journal-remote\n"})}),"\n",(0,n.jsx)(s.p,{children:"Verifique que la salida coincida con:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"systemd-journal-remote-<versi\xf3n>\n"})}),"\n",(0,n.jsx)(s.h4,{id:"remediaci\xf3n",children:"Remediaci\xf3n:"}),"\n",(0,n.jsxs)(s.p,{children:["Ejecute el siguiente comando para instalar ",(0,n.jsx)(s.code,{children:"systemd-journal-remote"}),":"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"dnf install systemd-journal-remote\n"})}),"\n",(0,n.jsx)(s.h4,{id:"referencias",children:"Referencias:"}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsx)(s.li,{children:"NIST SP 800-53 Rev. 5: AU-2, AU-7 AU-12"}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"controles-cis",children:"Controles CIS:"}),"\n",(0,n.jsx)(s.h2,{id:"62212-asegurar-que-la-autenticaci\xf3n-de-systemd-journal-upload-est\xe9-configurada-manual",children:"6.2.2.1.2 Asegurar que la autenticaci\xf3n de systemd-journal-upload est\xe9 configurada (Manual)"}),"\n",(0,n.jsx)(s.h3,{id:"aplicabilidad-del-perfil-1",children:"Aplicabilidad del perfil:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"Nivel 1 - Servidor"}),"\n",(0,n.jsx)(s.li,{children:"Nivel 1 - Estaci\xf3n de trabajo"}),"\n"]}),"\n",(0,n.jsx)(s.h3,{id:"descripci\xf3n-1",children:"Descripci\xf3n:"}),"\n",(0,n.jsxs)(s.p,{children:["Journal ",(0,n.jsx)(s.strong,{children:"systemd-journal-upload"})," admite la capacidad de enviar eventos de registro que recopila a un host de registro remoto."]}),"\n",(0,n.jsx)(s.h3,{id:"justificaci\xf3n-1",children:"Justificaci\xf3n:"}),"\n",(0,n.jsx)(s.p,{children:"Almacenar datos de registro en un host remoto protege la integridad de los registros contra ataques locales. Si un atacante obtiene acceso root en el sistema local, podr\xeda manipular o eliminar datos de registro almacenados en el sistema local."}),"\n",(0,n.jsxs)(s.blockquote,{children:["\n",(0,n.jsxs)(s.p,{children:["\u2139 ",(0,n.jsx)(s.strong,{children:"Nota:"})," Esta recomendaci\xf3n ",(0,n.jsx)(s.strong,{children:"solo aplica si journald es el m\xe9todo elegido para el registro del cliente"}),". No aplique esta recomendaci\xf3n si se utiliza ",(0,n.jsx)(s.strong,{children:"rsyslog"}),"."]}),"\n"]}),"\n",(0,n.jsx)(s.h3,{id:"auditor\xeda-1",children:"Auditor\xeda:"}),"\n",(0,n.jsxs)(s.p,{children:["Ejecute el siguiente comando para verificar que la autenticaci\xf3n de ",(0,n.jsx)(s.strong,{children:"systemd-journal-upload"})," est\xe1 configurada:"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:'grep -P "^ *URL=|^ *ServerKeyFile=|^ *ServerCertificateFile=|^ *TrustedCertificateFile=" /etc/systemd/journal-upload.conf\n'})}),"\n",(0,n.jsx)(s.p,{children:"Verifique que la salida coincida con las ubicaciones de los certificados de su entorno y la URL del servidor de registros:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"[Upload] \r\nURL=192.168.50.42\r\nServerKeyFile=/etc/ssl/private/journal-upload.pem\r\nServerCertificateFile=/etc/ssl/certs/journal-upload.pem\r\nTrustedCertificateFile=/etc/ssl/ca/trusted.pem\n"})}),"\n",(0,n.jsx)(s.h3,{id:"remediaci\xf3n-1",children:"Remediaci\xf3n:"}),"\n",(0,n.jsxs)(s.p,{children:["Edite el archivo ",(0,n.jsx)(s.code,{children:"/etc/systemd/journal-upload.conf"})," o un archivo en",(0,n.jsx)(s.br,{}),"\n",(0,n.jsx)(s.code,{children:"/etc/systemd/journal-upload.conf.d"})," con la extensi\xf3n ",(0,n.jsx)(s.code,{children:".conf"})," y aseg\xfarese de que las siguientes l\xedneas est\xe9n configuradas en la secci\xf3n ",(0,n.jsx)(s.code,{children:"[Upload]"})," seg\xfan su entorno:"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"[Upload]\r\nURL=192.168.50.42\r\nServerKeyFile=/etc/ssl/private/journal-upload.pem\r\nServerCertificateFile=/etc/ssl/certs/journal-upload.pem\r\nTrustedCertificateFile=/etc/ssl/ca/trusted.pem\n"})}),"\n",(0,n.jsx)(s.p,{children:"Reiniciar el servicio:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"systemctl restart systemd-journal-upload\n"})}),"\n",(0,n.jsx)(s.h3,{id:"referencias-1",children:"Referencias"}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsx)(s.li,{children:"NIST SP 800-53 Rev. 5: AU-2, AU-12"}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"controles-cis-1",children:"Controles CIS:"}),"\n",(0,n.jsx)(s.h3,{id:"62213-asegurar-que-systemd-journal-upload-est\xe9-habilitado-y-activo-automatizado",children:"6.2.2.1.3 Asegurar que systemd-journal-upload est\xe9 habilitado y activo (Automatizado)"}),"\n",(0,n.jsx)(s.h4,{id:"aplicabilidad-del-perfil-2",children:"Aplicabilidad del perfil:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"Nivel 1 - Servidor"}),"\n",(0,n.jsx)(s.li,{children:"Nivel 1 - Estaci\xf3n de trabajo"}),"\n"]}),"\n",(0,n.jsx)(s.h4,{id:"descripci\xf3n-2",children:"Descripci\xf3n:"}),"\n",(0,n.jsxs)(s.p,{children:["Journal ",(0,n.jsx)(s.strong,{children:"systemd-journal-upload"})," admite la capacidad de enviar eventos de registro que recopila a un host de registro remoto."]}),"\n",(0,n.jsx)(s.h4,{id:"justificaci\xf3n-2",children:"Justificaci\xf3n:"}),"\n",(0,n.jsx)(s.p,{children:"Almacenar datos de registro en un host remoto protege la integridad de los registros contra ataques locales. Si un atacante obtiene acceso root en el sistema local, podr\xeda manipular o eliminar datos de registro almacenados en el sistema local."}),"\n",(0,n.jsxs)(s.blockquote,{children:["\n",(0,n.jsxs)(s.p,{children:["\u2139 ",(0,n.jsx)(s.strong,{children:"Nota:"})," Esta recomendaci\xf3n ",(0,n.jsx)(s.strong,{children:"solo aplica si journald es el m\xe9todo elegido para el registro del cliente"}),". No aplique esta recomendaci\xf3n si se utiliza ",(0,n.jsx)(s.strong,{children:"rsyslog"}),"."]}),"\n"]}),"\n",(0,n.jsx)(s.h4,{id:"auditor\xeda-2",children:"Auditor\xeda:"}),"\n",(0,n.jsxs)(s.p,{children:["Ejecute el siguiente comando para verificar que ",(0,n.jsx)(s.code,{children:"systemd-journal-upload"})," est\xe1 habilitado:"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"# systemctl is-enabled systemd-journal-upload.service enabled\r\nenabled\n"})}),"\n",(0,n.jsxs)(s.p,{children:["Ejecute el siguiente comando para verificar que ",(0,n.jsx)(s.code,{children:"systemd-journal-upload"})," est\xe9 activo:"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"# systemctl is-active systemd-journal-upload.service\r\nactive\n"})}),"\n",(0,n.jsx)(s.h4,{id:"remediaci\xf3n-2",children:"Remediaci\xf3n:"}),"\n",(0,n.jsxs)(s.p,{children:["Ejecute los siguientes comandos para desenmascarar, habilitar e iniciar ",(0,n.jsx)(s.code,{children:"systemd-journal-upload"}),":"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"# systemctl unmask systemd-journal-upload.service\r\n# systemctl --now enable systemd-journal-upload.service\r\nactive\n"})}),"\n",(0,n.jsx)(s.h4,{id:"referencia",children:"Referencia:"}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsx)(s.li,{children:"NIST SP 800-53 Rev. 5: AU-2, AU-12"}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"controles-cis-2",children:"Controles CIS:"}),"\n",(0,n.jsx)(s.h3,{id:"62214-asegurar-que-el-servicio-systemd-journal-remote-no-est\xe9-en-uso-automatizado",children:"6.2.2.1.4 Asegurar que el servicio systemd-journal-remote no est\xe9 en uso (Automatizado)"}),"\n",(0,n.jsx)(s.h4,{id:"aplicabilidad-del-perfil-3",children:"Aplicabilidad del perfil:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"Nivel 1 - Servidor"}),"\n",(0,n.jsx)(s.li,{children:"Nivel 1 - Estaci\xf3n de trabajo"}),"\n"]}),"\n",(0,n.jsx)(s.h4,{id:"descripci\xf3n-3",children:"Descripci\xf3n:"}),"\n",(0,n.jsxs)(s.p,{children:["Journal ",(0,n.jsx)(s.code,{children:"systemd-journal-remote"})," admite la capacidad de recibir mensajes de hosts remotos, actuando as\xed como un servidor de registros. Los clientes no deber\xedan recibir datos de otros hosts."]}),"\n",(0,n.jsxs)(s.blockquote,{children:["\n",(0,n.jsxs)(s.p,{children:["\u2139 ",(0,n.jsx)(s.strong,{children:"Nota:"})]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["El mismo paquete, ",(0,n.jsx)(s.code,{children:"systemd-journal-remote"}),", se usa tanto para enviar registros a hosts remotos como para recibir registros entrantes."]}),"\n",(0,n.jsxs)(s.li,{children:["En cuanto a la recepci\xf3n de registros, existen dos servicios: ",(0,n.jsx)(s.code,{children:"systemd-journal-remote.socket"})," y ",(0,n.jsx)(s.code,{children:"systemd-journal-remote.service"}),"."]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(s.h4,{id:"justificaci\xf3n-3",children:"Justificaci\xf3n:"}),"\n",(0,n.jsx)(s.p,{children:"Si un cliente est\xe1 configurado para recibir datos, convirti\xe9ndose en un servidor, el sistema cliente est\xe1 operando fuera de su l\xedmite funcional."}),"\n",(0,n.jsxs)(s.blockquote,{children:["\n",(0,n.jsxs)(s.p,{children:["\u2139 ",(0,n.jsx)(s.strong,{children:"Nota:"})," Esta recomendaci\xf3n ",(0,n.jsx)(s.strong,{children:"solo aplica si journald es el m\xe9todo elegido para el registro del cliente"}),". No aplique esta recomendaci\xf3n si se utiliza ",(0,n.jsx)(s.code,{children:"rsyslog"}),"."]}),"\n"]}),"\n",(0,n.jsx)(s.h4,{id:"auditor\xeda-3",children:"Auditor\xeda:"}),"\n",(0,n.jsxs)(s.p,{children:["Ejecute el siguiente comando para verificar que ",(0,n.jsx)(s.code,{children:"systemd-journal-remote.socket"})," y ",(0,n.jsx)(s.code,{children:"systemd-journal-remote.service"})," no est\xe9n habilitados:"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"# systemctl is-enabled systemd-journal-remote.socket systemd-journal-remote.service | grep -P -- '^enabled'\n"})}),"\n",(0,n.jsxs)(s.p,{children:["No se debe devolver nada\r\nEjecute el siguiente comando para verificar que ",(0,n.jsx)(s.code,{children:"systemd-journal-remote.socket"})," y ",(0,n.jsx)(s.code,{children:"systemd-journal-remote.service"})," no est\xe9n activos:"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"# systemctl is-active systemd-journal-remote.socket systemd-journal-remote.service | grep -P -- '^active'\n"})}),"\n",(0,n.jsx)(s.p,{children:"No se debe devolver nada"}),"\n",(0,n.jsx)(s.h4,{id:"reneduaci\xf3n",children:"Reneduaci\xf3n"}),"\n",(0,n.jsx)(s.p,{children:"Ejecute los siguientes comandos para detener y enmascarar systemd-journal-remote.socket y systemd-journal-remote.service:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"# systemctl stop systemd-journal-remote.socket systemd-journal-remote.service \r\n# systemctl mask systemd-journal-remote.socket systemd-journal-remote.service\n"})}),"\n",(0,n.jsx)(s.h4,{id:"referencias-2",children:"Referencias:"}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsx)(s.li,{children:"NIST SP 800-53 Rev. 5: AU-2, AU-7 AU-12"}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"controles-cis-3",children:"Controles CIS:"}),"\n",(0,n.jsx)(s.h3,{id:"6222-asegurar-que-forwardtosyslog-de-journald-est\xe9-deshabilitado-automatizado",children:"6.2.2.2 Asegurar que ForwardToSyslog de journald est\xe9 deshabilitado (Automatizado)"}),"\n",(0,n.jsx)(s.h4,{id:"aplicabilidad-del-perfil-4",children:"Aplicabilidad del perfil:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"Nivel 1 - Servidor"}),"\n",(0,n.jsx)(s.li,{children:"Nivel 1 - Estaci\xf3n de trabajo"}),"\n"]}),"\n",(0,n.jsx)(s.h4,{id:"descripci\xf3n-4",children:"Descripci\xf3n:"}),"\n",(0,n.jsxs)(s.p,{children:["Los datos de ",(0,n.jsx)(s.strong,{children:"journald"})," deben permanecer dentro del servicio y no ser reenviados a otros servicios."]}),"\n",(0,n.jsx)(s.h4,{id:"justificaci\xf3n-4",children:"Justificaci\xf3n:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"SI"})," ",(0,n.jsx)(s.strong,{children:"journald"})," es el m\xe9todo para capturar registros, todos los registros del sistema deben ser manejados por ",(0,n.jsx)(s.strong,{children:"journald"})," y no ser reenviados a otros mecanismos de registro."]}),"\n"]}),"\n",(0,n.jsxs)(s.blockquote,{children:["\n",(0,n.jsxs)(s.p,{children:["\u2139 ",(0,n.jsx)(s.strong,{children:"Nota:"})," Esta recomendaci\xf3n ",(0,n.jsx)(s.strong,{children:"solo aplica si journald es el m\xe9todo elegido para el registro del cliente"}),". No aplique esta recomendaci\xf3n si se utiliza ",(0,n.jsx)(s.strong,{children:"rsyslog"}),"."]}),"\n"]}),"\n",(0,n.jsx)(s.h4,{id:"auditor\xeda-4",children:"Auditor\xeda:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"SI"})," ",(0,n.jsx)(s.strong,{children:"journald"})," es el m\xe9todo para capturar registros",(0,n.jsx)(s.br,{}),"\n","Ejecute el siguiente comando para verificar que ",(0,n.jsx)(s.strong,{children:"ForwardToSyslog"})," est\xe9 configurado en ",(0,n.jsx)(s.strong,{children:"no"}),":"]}),"\n"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:'# systemd-analyze cat-config systemd/journald.conf systemd/journald.conf.d/*\r\n| grep -E "^ForwardToSyslog=no"\r\nForwardToSyslog=no\n'})}),"\n",(0,n.jsx)(s.h4,{id:"remediaci\xf3n-3",children:"Remediaci\xf3n:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"SI"})," ",(0,n.jsx)(s.code,{children:"rsyslog"}),' es el m\xe9todo preferido para capturar registros, esta secci\xf3n y la recomendaci\xf3n deben omitirse, y se debe seguir la secci\xf3n "Configurar rsyslog".']}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"SI"})," ",(0,n.jsx)(s.code,{children:"journald"})," es el m\xe9todo preferido para capturar registros:"]}),"\n",(0,n.jsxs)(s.p,{children:["Establezca el siguiente par\xe1metro en la secci\xf3n ",(0,n.jsx)(s.strong,{children:"[Journal]"})," en ",(0,n.jsx)(s.code,{children:"/etc/systemd/journald.conf"})," o en un archivo dentro de ",(0,n.jsx)(s.code,{children:"/etc/systemd/journald.conf.d/"})," que termine en ",(0,n.jsx)(s.code,{children:".conf"}),":"]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"ForwardToSyslog=no\n"})}),"\n",(0,n.jsx)(s.p,{children:"ejemplos"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"#!/usr/bin/env bash\r\n\r\n{\r\n    [ ! -d /etc/systemd/journald.conf.d/ ] && mkdir /etc/systemd/journald.conf.d/\r\n\r\n    if grep -Psq -- '^\\h*\\t*\\[Journal\\]' /etc/systemd/journald.conf.d/60-journald.conf; then\r\n        printf '%s\\n' \"ForwardToSyslog=no\" >> /etc/systemd/journald.conf.d/60-journald.conf\r\n    else\r\n        printf '%s\\n' \"[Journal]\" \"ForwardToSyslog=no\" >> /etc/systemd/journald.conf.d/60-journald.conf\r\n    fi\r\n}\n"})}),"\n",(0,n.jsxs)(s.blockquote,{children:["\n",(0,n.jsxs)(s.p,{children:["\u2139 ",(0,n.jsx)(s.strong,{children:"Nota:"}),"\r\nSi esta configuraci\xf3n aparece en un archivo can\xf3nicamente posterior o m\xe1s adelante en el mismo archivo, la configuraci\xf3n ser\xe1 sobrescrita."]}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:"Ejecute el siguiente comando para actualizar los par\xe1metros en el servicio:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"# systemctl reload-or-restart systemd-journald\n"})}),"\n",(0,n.jsx)(s.p,{children:"Valor por defecto:\r\nForwardToSyslog=no"}),"\n",(0,n.jsx)(s.h4,{id:"referencias-3",children:"Referencias:"}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsx)(s.li,{children:"NIST SP 800-53 Rev. 5: AU-2, AU-6, AU-7, AU-12"}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"controles-cis-4",children:"Controles CIS:"}),"\n",(0,n.jsx)(s.h3,{id:"6223-asegurar-que-journald-compress-est\xe9-configurado-automatizado",children:"6.2.2.3 Asegurar que journald Compress est\xe9 configurado (Automatizado)"}),"\n",(0,n.jsx)(s.h4,{id:"aplicabilidad-del-perfil-5",children:"Aplicabilidad del perfil:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"Nivel 1 - Servidor"}),"\n",(0,n.jsx)(s.li,{children:"Nivel 1 - Estaci\xf3n de trabajo"}),"\n"]}),"\n",(0,n.jsx)(s.h4,{id:"descripci\xf3n-5",children:"Descripci\xf3n:"}),"\n",(0,n.jsxs)(s.p,{children:["El sistema ",(0,n.jsx)(s.strong,{children:"journald"})," incluye la capacidad de comprimir archivos excesivamente grandes para evitar que el sistema se llene con registros o que los registros sean incontrolablemente grandes."]}),"\n",(0,n.jsx)(s.h4,{id:"justificaci\xf3n-5",children:"Justificaci\xf3n:"}),"\n",(0,n.jsx)(s.p,{children:"Los archivos grandes sin comprimir pueden llenar inesperadamente un sistema de archivos, lo que lleva a la indisponibilidad de recursos. Comprimir los registros antes de escribirlos puede prevenir impactos repentinos e inesperados en el sistema de archivos."}),"\n",(0,n.jsxs)(s.blockquote,{children:["\n",(0,n.jsxs)(s.p,{children:["\u2139 ",(0,n.jsx)(s.strong,{children:"Nota:"})," Esta recomendaci\xf3n ",(0,n.jsx)(s.strong,{children:"solo aplica si journald es el m\xe9todo elegido para el registro del cliente"}),". No aplique esta recomendaci\xf3n si se utiliza ",(0,n.jsx)(s.strong,{children:"rsyslog"}),"."]}),"\n"]}),"\n",(0,n.jsx)(s.h4,{id:"auditor\xeda-5",children:"Auditor\xeda:"}),"\n",(0,n.jsxs)(s.p,{children:["Ejecute el siguiente comando para verificar que ",(0,n.jsx)(s.strong,{children:"Compress"})," est\xe9 configurado en ",(0,n.jsx)(s.strong,{children:"yes"}),":"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:'# systemd-analyze cat-config systemd/journald.conf systemd/journald.conf.d/* \\\r\n| grep -E "^Compress=yes"\r\n\r\nCompress=yes\n'})}),"\n",(0,n.jsx)(s.h4,{id:"remediaci\xf3n-4",children:"Remediaci\xf3n:"}),"\n",(0,n.jsxs)(s.p,{children:["Establezca el siguiente par\xe1metro en la secci\xf3n ",(0,n.jsx)(s.code,{children:"[Journal]"})," en ",(0,n.jsx)(s.code,{children:"/etc/systemd/journald.conf"})," o en un archivo dentro de ",(0,n.jsx)(s.code,{children:"/etc/systemd/journald.conf.d/"})," que termine en ",(0,n.jsx)(s.code,{children:".conf"}),":"]}),"\n",(0,n.jsx)(s.h4,{id:"ejemplo",children:"Ejemplo:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"#!/usr/bin/env bash\r\n\r\n{\r\n    [ ! -d /etc/systemd/journald.conf.d/ ] && mkdir /etc/systemd/journald.conf.d/\r\n\r\n    if grep -Psq -- '^\\h*\\t*\\[Journal\\]' /etc/systemd/journald.conf.d/60-journald.conf; then\r\n        printf '%s\\n' \"Compress=yes\" >> /etc/systemd/journald.conf.d/60-journald.conf\r\n    else\r\n        printf '%s\\n' \"[Journal]\" \"Compress=yes\" >> /etc/systemd/journald.conf.d/60-journald.conf\r\n    fi\r\n}\n"})}),"\n",(0,n.jsxs)(s.blockquote,{children:["\n",(0,n.jsxs)(s.p,{children:["\u2139 ",(0,n.jsx)(s.strong,{children:"Nota:"}),"\r\nSi esta configuraci\xf3n aparece en un archivo can\xf3nicamente posterior o m\xe1s adelante en el mismo archivo, la configuraci\xf3n ser\xe1 sobrescrita."]}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:"Ejecute el siguiente comando para actualizar los par\xe1metros en el servicio:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"# systemctl reload-or-restart systemd-journald\n"})}),"\n",(0,n.jsx)(s.h4,{id:"referencias-4",children:"Referencias"}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsx)(s.li,{children:"NIST SP 800-53 Rev. 5: AU-4"}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"controles-cis-5",children:"Controles CIS:"}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(s.h2,{id:"mapeo-de-mitre-attck",children:"Mapeo de MITRE ATT&CK:"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"T\xe9cnicas / Subt\xe9cnicas"}),(0,n.jsx)(s.th,{children:"T\xe1cticas"}),(0,n.jsx)(s.th,{children:"Mitigaciones"})]})}),(0,n.jsx)(s.tbody,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"T1562, T1562.001"}),(0,n.jsx)(s.td,{children:"TA0040"}),(0,n.jsx)(s.td,{children:"M1053"})]})})]}),"\n",(0,n.jsx)(s.h3,{id:"6224-asegurar-que-journald-storage-est\xe9-configurado-automatizado",children:"6.2.2.4 Asegurar que journald Storage est\xe9 configurado (Automatizado)"}),"\n",(0,n.jsx)(s.h4,{id:"aplicabilidad-del-perfil-6",children:"Aplicabilidad del perfil:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"Nivel 1 - Servidor"}),"\n",(0,n.jsx)(s.li,{children:"Nivel 1 - Estaci\xf3n de trabajo"}),"\n"]}),"\n",(0,n.jsx)(s.h4,{id:"descripci\xf3n-6",children:"Descripci\xf3n:"}),"\n",(0,n.jsxs)(s.p,{children:["Los datos de ",(0,n.jsx)(s.strong,{children:"journald"})," pueden almacenarse en memoria vol\xe1til o persistirse localmente en el servidor.",(0,n.jsx)(s.br,{}),"\n","Los registros en memoria se perder\xe1n tras un reinicio del sistema.",(0,n.jsx)(s.br,{}),"\n","Al persistir los registros en el disco local del servidor, est\xe1n protegidos contra la p\xe9rdida de datos debido a un reinicio."]}),"\n",(0,n.jsx)(s.h4,{id:"justificaci\xf3n-6",children:"Justificaci\xf3n:"}),"\n",(0,n.jsxs)(s.p,{children:["Escribir los datos de registro en el disco permite la capacidad de reconstrucci\xf3n forense de eventos",(0,n.jsx)(s.br,{}),"\n","que pudieron haber afectado las operaciones o la seguridad de un sistema, incluso despu\xe9s de un fallo o reinicio."]}),"\n",(0,n.jsxs)(s.blockquote,{children:["\n",(0,n.jsxs)(s.p,{children:["\u2139 ",(0,n.jsx)(s.strong,{children:"Nota:"})," Esta recomendaci\xf3n ",(0,n.jsxs)(s.strong,{children:["solo aplica si ",(0,n.jsx)(s.code,{children:"journald"})," es el m\xe9todo elegido para el registro del cliente"]}),". No aplique esta recomendaci\xf3n si se utiliza ",(0,n.jsx)(s.code,{children:"rsyslog"}),"."]}),"\n"]}),"\n",(0,n.jsx)(s.h4,{id:"auditor\xeda-6",children:"Auditor\xeda:"}),"\n",(0,n.jsxs)(s.p,{children:["Ejecute el siguiente comando para verificar que ",(0,n.jsx)(s.code,{children:"Storage"})," est\xe9 configurado en ",(0,n.jsx)(s.code,{children:"persistent"}),":"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:'# systemd-analyze cat-config systemd/journald.conf systemd/journald.conf.d/* \\\r\n| grep -E "^Storage=persistent"\r\n\r\nStorage=persistent\n'})}),"\n",(0,n.jsx)(s.h4,{id:"remediaci\xf3n-5",children:"Remediaci\xf3n:"}),"\n",(0,n.jsxs)(s.p,{children:["Establezca el siguiente par\xe1metro en la secci\xf3n ",(0,n.jsx)(s.code,{children:"[Journal]"})," en ",(0,n.jsx)(s.code,{children:"/etc/systemd/journald.conf"})," o en un archivo dentro de ",(0,n.jsx)(s.code,{children:"/etc/systemd/journald.conf.d/"})," que termine en ",(0,n.jsx)(s.code,{children:".conf"}),":"]}),"\n",(0,n.jsx)(s.h4,{id:"ejemplo-1",children:"Ejemplo:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"#!/usr/bin/env bash\r\n\r\n{\r\n    [ ! -d /etc/systemd/journald.conf.d/ ] && mkdir /etc/systemd/journald.conf.d/\r\n\r\n    if grep -Psq -- '^\\h*\\t*\\[Journal\\]' /etc/systemd/journald.conf.d/60-journald.conf; then\r\n        printf '%s\\n' \"Storage=persistent\" >> /etc/systemd/journald.conf.d/60-journald.conf\r\n    else\r\n        printf '%s\\n' \"[Journal]\" \"Storage=persistent\" >> /etc/systemd/journald.conf.d/60-journald.conf\r\n    fi\r\n}\n"})}),"\n",(0,n.jsxs)(s.blockquote,{children:["\n",(0,n.jsxs)(s.p,{children:["\u2139 ",(0,n.jsx)(s.strong,{children:"Nota:"}),"\r\nSi esta configuraci\xf3n aparece en un archivo can\xf3nicamente posterior o m\xe1s adelante en el mismo archivo, la configuraci\xf3n ser\xe1 sobrescrita."]}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:"Ejecute el siguiente comando para actualizar los par\xe1metros en el servicio:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"# systemctl reload-or-restart systemd-journald\n"})}),"\n",(0,n.jsx)(s.h4,{id:"referencia-1",children:"Referencia"}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsx)(s.li,{children:"NIST SP 800-53 Rev. 5: AU-3, AU-12"}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"controles-cis-6",children:"Controles CIS:"}),"\n",(0,n.jsx)(s.h2,{id:"mapeo-de-mitre-attck-1",children:"Mapeo de MITRE ATT&CK:"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"T\xe9cnicas / Subt\xe9cnicas"}),(0,n.jsx)(s.th,{children:"T\xe1cticas"}),(0,n.jsx)(s.th,{children:"Mitigaciones"})]})}),(0,n.jsx)(s.tbody,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"T1070, T1070.002, T1562, T1562.006"}),(0,n.jsx)(s.td,{children:"TA0005"}),(0,n.jsx)(s.td,{children:"M1022"})]})})]}),"\n",(0,n.jsx)(s.h2,{id:"623-configurar-rsyslog",children:"6.2.3 Configurar rsyslog"}),"\n",(0,n.jsxs)(s.p,{children:["El paquete de software ",(0,n.jsx)(s.code,{children:"rsyslog"})," puede utilizarse en lugar del mecanismo de registro predeterminado ",(0,n.jsx)(s.code,{children:"journald"}),"."]}),"\n",(0,n.jsx)(s.p,{children:'Rsyslog ha evolucionado a lo largo de varias d\xe9cadas. Por esta raz\xf3n, admite tres formatos de configuraci\xf3n diferentes ("lenguajes"):'}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.code,{children:"b\xe1sico"})})," - anteriormente conocido como el formato ",(0,n.jsx)(s.code,{children:"sysklogd"}),", este es el formato mejor utilizado para expresar configuraciones simples, como la ubicaci\xf3n de una declaraci\xf3n en una sola l\xednea."]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["Se remonta al formato original ",(0,n.jsx)(s.code,{children:"syslog.conf"}),", que ha estado en uso durante varias d\xe9cadas."]}),"\n",(0,n.jsx)(s.li,{children:"El caso de uso m\xe1s com\xfan es la coincidencia basada en facilidad/gravedad y la escritura de mensajes coincidentes en un archivo de registro."}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.code,{children:"avanzado"})})," - anteriormente conocido como el formato ",(0,n.jsx)(s.code,{children:"RainerScript"}),", este formato estuvo disponible por primera vez en rsyslog v6 y es el formato m\xe1s preciso y moderno para casos de uso no triviales donde se necesita m\xe1s de una l\xednea."]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"Antes de la versi\xf3n 7, hab\xeda un impacto en el rendimiento al usar este formato, lo que alentaba el uso del formato b\xe1sico para obtener mejores resultados. Las versiones actuales de rsyslog no sufren este impacto de rendimiento (hist\xf3rico)."}),"\n",(0,n.jsx)(s.li,{children:"Este nuevo formato est\xe1 espec\xedficamente dirigido a casos de uso m\xe1s avanzados, como el reenv\xedo de registros a hosts remotos que podr\xedan estar disponibles solo parcialmente."}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.code,{children:"obsoleto (legado)"})})," - anteriormente conocido simplemente como el formato ",(0,n.jsx)(s.code,{children:"legacy"}),", este formato es exactamente lo que su nombre indica: obsoleto y no deber\xeda usarse al escribir nuevas configuraciones. Fue creado en los primeros d\xedas (hasta rsyslog versi\xf3n 5), cuando se esperaba que rsyslog extendiera ",(0,n.jsx)(s.strong,{children:"sysklogd"})," solo ligeramente. En consecuencia, su prop\xf3sito principal era realizar peque\xf1os ajustes al formato original ",(0,n.jsx)(s.strong,{children:"sysklogd"}),"."]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"La pr\xe1ctica ha demostrado que era notoriamente dif\xedcil de usar para casos de uso m\xe1s avanzados, por lo que fue reemplazado por el formato avanzado."}),"\n",(0,n.jsxs)(s.li,{children:["En esencia, cualquier configuraci\xf3n escrita en una sola l\xednea que comience con un signo de d\xf3lar (",(0,n.jsx)(s.code,{children:"$"}),") es un formato legado. Los usuarios de este formato deben ",(0,n.jsx)(s.strong,{children:"migrar a los formatos b\xe1sico o avanzado"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(s.blockquote,{children:["\n",(0,n.jsxs)(s.p,{children:["\u2139 ",(0,n.jsx)(s.strong,{children:"Nota:"}),":\r\nEsta secci\xf3n ",(0,n.jsxs)(s.strong,{children:["solo aplica si ",(0,n.jsx)(s.code,{children:"rsyslog"})," es el m\xe9todo elegido para el registro del cliente"]}),". No aplique esta secci\xf3n si se utiliza ",(0,n.jsx)(s.code,{children:"journald"}),"."]}),"\n"]}),"\n",(0,n.jsx)(s.h3,{id:"6231-asegurar-que-rsyslog-est\xe9-instalado-automatizado",children:"6.2.3.1 Asegurar que rsyslog est\xe9 instalado (Automatizado)"}),"\n",(0,n.jsx)(s.h4,{id:"aplicabilidad-del-perfil-7",children:"Aplicabilidad del perfil:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"Nivel 1 - Servidor"}),"\n",(0,n.jsx)(s.li,{children:"Nivel 1 - Estaci\xf3n de trabajo"}),"\n"]}),"\n",(0,n.jsx)(s.h4,{id:"descripci\xf3n-7",children:"Descripci\xf3n:"}),"\n",(0,n.jsxs)(s.p,{children:["El software ",(0,n.jsx)(s.strong,{children:"rsyslog"})," se recomienda en entornos donde ",(0,n.jsx)(s.strong,{children:"journald"})," no cumple con los requisitos operativos."]}),"\n",(0,n.jsx)(s.h4,{id:"justificaci\xf3n-7",children:"Justificaci\xf3n:"}),"\n",(0,n.jsxs)(s.p,{children:["Las mejoras de seguridad de ",(0,n.jsx)(s.strong,{children:"rsyslog"}),", como la transmisi\xf3n de registros orientada a conexi\xf3n (por ejemplo, TCP),",(0,n.jsx)(s.br,{}),"\n","la opci\xf3n de registrar datos en formatos de bases de datos y el cifrado de los registros en tr\xe1nsito hacia un servidor central de registros,",(0,n.jsx)(s.br,{}),"\n","justifican la instalaci\xf3n y configuraci\xf3n de este paquete."]}),"\n",(0,n.jsxs)(s.blockquote,{children:["\n",(0,n.jsxs)(s.p,{children:["\u2139 ",(0,n.jsx)(s.strong,{children:"Nota:"}),": Esta recomendaci\xf3n ",(0,n.jsx)(s.strong,{children:"solo aplica si rsyslog es el m\xe9todo elegido para el registro del cliente"}),".",(0,n.jsx)(s.br,{}),"\n","No aplique esta recomendaci\xf3n si se utiliza ",(0,n.jsx)(s.strong,{children:"journald"}),"."]}),"\n"]}),"\n",(0,n.jsx)(s.h4,{id:"auditor\xeda-7",children:"Auditor\xeda:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"SI"})," ",(0,n.jsx)(s.strong,{children:"rsyslog"})," se usa para el registro en el sistema:",(0,n.jsx)(s.br,{}),"\n","Ejecute el siguiente comando para verificar que ",(0,n.jsx)(s.strong,{children:"rsyslog"})," est\xe1 instalado:"]}),"\n"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"# rpm -q rsyslog\n"})}),"\n",(0,n.jsx)(s.p,{children:"Verifique que la salida coincida:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"rsyslog-<version>\n"})}),"\n",(0,n.jsx)(s.h4,{id:"recomendaci\xf3n",children:"Recomendaci\xf3n:"}),"\n",(0,n.jsx)(s.p,{children:"Ejecute el siguiente comando para instalar rsyslog:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"# dnf install rsyslog\n"})}),"\n",(0,n.jsx)(s.h4,{id:"valor-predeterminado",children:"Valor predeterminado:"}),"\n",(0,n.jsx)(s.p,{children:"Instalado"}),"\n",(0,n.jsx)(s.h4,{id:"referencias-5",children:"Referencias:"}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsx)(s.li,{children:"NIST SP 800-53 Rev. 5: AU-2, AU-3, AU-12"}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"controles-cis-7",children:"Controles CIS:"}),"\n",(0,n.jsx)(s.h2,{id:"mapeo-de-mitre-attck-2",children:"Mapeo de MITRE ATT&CK:"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"T\xe9cnicas / Subt\xe9cnicas"}),(0,n.jsx)(s.th,{children:"T\xe1cticas"}),(0,n.jsx)(s.th,{children:"Mitigaciones"})]})}),(0,n.jsx)(s.tbody,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"T1005, T1005.000, T1070, T1070.002"}),(0,n.jsx)(s.td,{children:"TA0005"}),(0,n.jsx)(s.td,{children:"M1029, M1057"})]})})]}),"\n",(0,n.jsx)(s.h3,{id:"6232-asegurar-que-el-servicio-rsyslog-est\xe9-habilitado-y-activo-automatizado",children:"6.2.3.2 Asegurar que el servicio rsyslog est\xe9 habilitado y activo (Automatizado)"}),"\n",(0,n.jsx)(s.h4,{id:"aplicabilidad-del-perfil-8",children:"Aplicabilidad del perfil:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"Nivel 1 - Servidor"}),"\n",(0,n.jsx)(s.li,{children:"Nivel 1 - Estaci\xf3n de trabajo"}),"\n"]}),"\n",(0,n.jsx)(s.h4,{id:"descripci\xf3n-8",children:"Descripci\xf3n:"}),"\n",(0,n.jsxs)(s.p,{children:["Una vez que el paquete ",(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.code,{children:"rsyslog"})})," est\xe9 instalado, aseg\xfarese de que el servicio est\xe9 habilitado."]}),"\n",(0,n.jsx)(s.h4,{id:"justificaci\xf3n-8",children:"Justificaci\xf3n:"}),"\n",(0,n.jsxs)(s.p,{children:["Si el servicio ",(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.code,{children:"rsyslog"})})," no est\xe1 habilitado para iniciarse en el arranque, el sistema no capturar\xe1 eventos de registro."]}),"\n",(0,n.jsxs)(s.blockquote,{children:["\n",(0,n.jsxs)(s.p,{children:["\u2139 ",(0,n.jsx)(s.strong,{children:"Nota:"}),": Esta recomendaci\xf3n ",(0,n.jsx)(s.strong,{children:"solo aplica si rsyslog es el m\xe9todo elegido para el registro del cliente"}),".",(0,n.jsx)(s.br,{}),"\n","No aplique esta recomendaci\xf3n si se utiliza ",(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.code,{children:"journald"})}),"."]}),"\n"]}),"\n",(0,n.jsx)(s.h4,{id:"auditor\xeda-8",children:"Auditor\xeda:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"SI"})," ",(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.code,{children:"rsyslog"})})," se usa para el registro en el sistema:",(0,n.jsx)(s.br,{}),"\n","Ejecute el siguiente comando para verificar que ",(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.code,{children:"rsyslog.service"})})," est\xe1 habilitado:"]}),"\n"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"# systemctl is-enabled rsyslog\r\nenabled\n"})}),"\n",(0,n.jsxs)(s.p,{children:["Ejecute el siguiente comando para verificar que ",(0,n.jsx)(s.code,{children:"rsyslog.service"})," est\xe1 activo:"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"# systemctl is-active rsyslog.service\r\nactive\n"})}),"\n",(0,n.jsx)(s.h4,{id:"remediaci\xf3n-6",children:"Remediaci\xf3n:"}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"SI rsyslog"})," se usa para el registro en el sistema:\r\nEjecute los siguientes comandos para desmascarar, habilitar e iniciar ",(0,n.jsx)(s.code,{children:"rsyslog.service"}),":"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"# systemctl unmask rsyslog.service\r\n# systemctl enable rsyslog.service\r\n# systemctl start rsyslog.service\n"})}),"\n",(0,n.jsx)(s.h4,{id:"referencias-6",children:"Referencias:"}),"\n",(0,n.jsx)(s.p,{children:"NIST SP 800-53 Rev. 5: AU-2, AU-3, AU-12"}),"\n",(0,n.jsx)(s.h2,{id:"controles-cis-8",children:"Controles CIS:"}),"\n",(0,n.jsx)(s.h2,{id:"mapeo-de-mitre-attck-3",children:"Mapeo de MITRE ATT&CK:"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"T\xe9cnicas / Subt\xe9cnicas"}),(0,n.jsx)(s.th,{children:"T\xe1cticas"}),(0,n.jsx)(s.th,{children:"Mitigaciones"})]})}),(0,n.jsx)(s.tbody,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"T1070, T1070.002, T1211, T1562, T1562.001"}),(0,n.jsx)(s.td,{children:"TA0005"}),(0,n.jsx)(s.td,{children:"M1029"})]})})]}),"\n",(0,n.jsx)(s.h3,{id:"6233-asegurar-que-journald-est\xe9-configurado-para-enviar-registros-a-rsyslog-automatizado",children:"6.2.3.3 Asegurar que journald est\xe9 configurado para enviar registros a rsyslog (Automatizado)"}),"\n",(0,n.jsx)(s.h4,{id:"aplicabilidad-del-perfil-9",children:"Aplicabilidad del perfil:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"Nivel 1 - Servidor"}),"\n",(0,n.jsx)(s.li,{children:"Nivel 1 - Estaci\xf3n de trabajo"}),"\n"]}),"\n",(0,n.jsx)(s.h4,{id:"descripci\xf3n-9",children:"Descripci\xf3n:"}),"\n",(0,n.jsxs)(s.p,{children:["Los datos de ",(0,n.jsx)(s.strong,{children:"systemd-journald"})," pueden almacenarse en memoria vol\xe1til o persistirse localmente en el servidor.",(0,n.jsx)(s.br,{}),"\n","Existen utilidades para aceptar la exportaci\xf3n remota de registros de ",(0,n.jsx)(s.strong,{children:"systemd-journald"}),", sin embargo,",(0,n.jsx)(s.br,{}),"\n","el uso del servicio ",(0,n.jsx)(s.strong,{children:"rsyslog"})," proporciona un medio consistente para la recopilaci\xf3n y exportaci\xf3n de registros."]}),"\n",(0,n.jsx)(s.h4,{id:"justificaci\xf3n-9",children:"Justificaci\xf3n:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"SI"})," ",(0,n.jsx)(s.strong,{children:"rsyslog"})," es el m\xe9todo preferido para capturar registros, todos los registros del sistema deben enviarse a \xe9l para su procesamiento adicional."]}),"\n"]}),"\n",(0,n.jsx)(s.h4,{id:"impacto",children:"Impacto:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"SI"})," ",(0,n.jsx)(s.strong,{children:"journald"})," es el m\xe9todo preferido para capturar registros, esta secci\xf3n y su recomendaci\xf3n deben omitirse,",(0,n.jsx)(s.br,{}),"\n","y en su lugar, debe seguirse la secci\xf3n ",(0,n.jsx)(s.strong,{children:'"Configurar Journald"'}),"."]}),"\n"]}),"\n",(0,n.jsx)(s.h4,{id:"auditor\xeda-9",children:"Auditor\xeda:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"SI"})," ",(0,n.jsx)(s.strong,{children:"rsyslog"})," es el m\xe9todo preferido para capturar registros:",(0,n.jsx)(s.br,{}),"\n","Ejecute el siguiente comando para verificar que los registros se est\xe1n reenviando a ",(0,n.jsx)(s.strong,{children:"rsyslog"}),",",(0,n.jsx)(s.br,{}),"\n","configurando ",(0,n.jsx)(s.strong,{children:"ForwardToSyslog"})," en ",(0,n.jsx)(s.strong,{children:"yes"})," en la configuraci\xf3n de ",(0,n.jsx)(s.strong,{children:"systemd-journald"}),":"]}),"\n"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:'# systemd-analyze cat-config systemd/journald.conf systemd/journald.conf.d/* \\\r\n  | grep -E "^ForwardToSyslog=yes"\r\n\r\nForwardToSyslog=yes\n'})}),"\n",(0,n.jsx)(s.h4,{id:"remediaci\xf3n-7",children:"Remediaci\xf3n:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"SI"})," ",(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.code,{children:"rsyslog"})})," es el m\xe9todo preferido para capturar registros:",(0,n.jsx)(s.br,{}),"\n","Establezca el siguiente par\xe1metro en la secci\xf3n ",(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.code,{children:"[Journal]"})})," dentro de",(0,n.jsx)(s.br,{}),"\n",(0,n.jsx)(s.code,{children:"/etc/systemd/journald.conf"})," o en un archivo dentro de ",(0,n.jsx)(s.code,{children:"/etc/systemd/journald.conf.d/"}),(0,n.jsx)(s.br,{}),"\n","que termine en ",(0,n.jsx)(s.code,{children:".conf"}),":"]}),"\n"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"ForwardToSyslog=yes\n"})}),"\n",(0,n.jsx)(s.h4,{id:"ejemplo-2",children:"Ejemplo"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"#!/usr/bin/env bash\r\n\r\n{\r\n    [ ! -d /etc/systemd/journald.conf.d/ ] && mkdir /etc/systemd/journald.conf.d/\r\n\r\n    if grep -Psq -- '^\\h*\\t*\\[Journal\\]' /etc/systemd/journald.conf.d/60-journald.conf; then\r\n        printf '%s\\n' \"ForwardToSyslog=yes\" >> /etc/systemd/journald.conf.d/60-journald.conf\r\n    else\r\n        printf '%s\\n' \"[Journal]\" \"ForwardToSyslog=yes\" >> /etc/systemd/journald.conf.d/60-journald.conf\r\n    fi\r\n}\n"})}),"\n",(0,n.jsxs)(s.blockquote,{children:["\n",(0,n.jsxs)(s.p,{children:["\u2139 ",(0,n.jsx)(s.strong,{children:"Nota:"}),":\r\nSi esta configuraci\xf3n aparece en un archivo posterior can\xf3nicamente o m\xe1s adelante en el mismo archivo,",(0,n.jsx)(s.br,{}),"\n","la configuraci\xf3n ser\xe1 sobrescrita."]}),"\n"]}),"\n",(0,n.jsxs)(s.p,{children:["Ejecute el siguiente comando para actualizar los par\xe1metros en el servicio:",(0,n.jsx)(s.br,{}),"\n","Reinicie ",(0,n.jsx)(s.strong,{children:"systemd-journald.service"}),":"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"# systemctl reload-or-restart systemd-journald.service\n"})}),"\n",(0,n.jsx)(s.h4,{id:"referencia-2",children:"Referencia"}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsx)(s.li,{children:"NIST SP 800-53 Rev. 5: AC-3, AU-2, AU-4, AU-12, MP-2"}),"\n",(0,n.jsx)(s.li,{children:"SYSTEMD-JOURNALD.SERVICE(8)"}),"\n",(0,n.jsx)(s.li,{children:"JOURNALD.CONF(5)"}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"informaci\xf3n-adicional",children:"Informaci\xf3n adicional:"}),"\n",(0,n.jsxs)(s.p,{children:["Como se menciona en las p\xe1ginas del manual de ",(0,n.jsx)(s.strong,{children:"systemd-journald"}),", los registros de ",(0,n.jsx)(s.strong,{children:"systemd-journald"})," pueden exportarse a ",(0,n.jsx)(s.strong,{children:"rsyslog"})," ya sea a trav\xe9s del proceso mencionado aqu\xed o mediante una facilidad como ",(0,n.jsx)(s.strong,{children:"systemd-journal.service"}),". Existen compensaciones en cada implementaci\xf3n:"]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"ForwardToSyslog"})," capturar\xe1 inmediatamente todos los eventos",(0,n.jsx)(s.br,{}),"\n","(y los reenviar\xe1 a un servidor de registros externo si est\xe1 configurado correctamente),",(0,n.jsx)(s.br,{}),"\n","pero ",(0,n.jsx)(s.strong,{children:"puede no capturar todas las actividades de arranque"}),"."]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:["Mecanismos como ",(0,n.jsx)(s.strong,{children:"systemd-journal.service"}),", en cambio,",(0,n.jsx)(s.br,{}),"\n","registrar\xe1n los eventos de arranque, pero pueden retrasar el env\xedo de la informaci\xf3n a ",(0,n.jsx)(s.strong,{children:"rsyslog"}),",",(0,n.jsx)(s.br,{}),"\n","lo que conlleva el ",(0,n.jsx)(s.strong,{children:"riesgo de manipulaci\xf3n de registros antes de su exportaci\xf3n"}),"."]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"Es importante conocer las limitaciones de todas las herramientas empleadas para asegurar un sistema."})}),"\n",(0,n.jsx)(s.h2,{id:"controles-cis-9",children:"Controles CIS:"}),"\n",(0,n.jsx)(s.h2,{id:"mapeo-de-mitre-attck-4",children:"Mapeo de MITRE ATT&CK:"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"T\xe9cnicas / Subt\xe9cnicas"}),(0,n.jsx)(s.th,{children:"T\xe1cticas"}),(0,n.jsx)(s.th,{children:"Mitigaciones"})]})}),(0,n.jsx)(s.tbody,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"T1070, T1070.002, T1562, T1562.006, T1565"}),(0,n.jsx)(s.td,{children:"TA0040"}),(0,n.jsx)(s.td,{children:"M1029"})]})})]}),"\n",(0,n.jsx)(s.h3,{id:"6234-asegurar-que-el-modo-de-creaci\xf3n-de-archivos-de-registro-de-rsyslog-est\xe9-configurado-automatizado",children:"6.2.3.4 Asegurar que el modo de creaci\xf3n de archivos de registro de rsyslog est\xe9 configurado (Automatizado)"}),"\n",(0,n.jsx)(s.h4,{id:"aplicabilidad-del-perfil-10",children:"Aplicabilidad del Perfil:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"Nivel 1 - Servidor"}),"\n",(0,n.jsx)(s.li,{children:"Nivel 1 - Estaci\xf3n de trabajo"}),"\n"]}),"\n",(0,n.jsx)(s.h4,{id:"descripci\xf3n-10",children:"Descripci\xf3n:"}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.code,{children:"rsyslog"})})," crear\xe1 archivos de registro que no existen en el sistema."]}),"\n",(0,n.jsxs)(s.p,{children:["El par\xe1metro ",(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.code,{children:"$FileCreateMode"})})," permite especificar el modo de creaci\xf3n con el cual ",(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.code,{children:"rsyslog"})})," crea nuevos archivos.",(0,n.jsx)(s.br,{}),"\n","Si no se especifica, se usa el valor ",(0,n.jsx)(s.code,{children:"0644"})," (que mantiene compatibilidad con versiones anteriores).",(0,n.jsx)(s.br,{}),"\n","El valor siempre debe ser un n\xfamero octal de 4 d\xedgitos, donde el primer d\xedgito debe ser cero."]}),"\n",(0,n.jsxs)(s.p,{children:["Tenga en cuenta que los permisos reales dependen de la umask del proceso de ",(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.code,{children:"rsyslog"})}),"."]}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.code,{children:"$FileCreateMode"})})," puede especificarse varias veces. Si es as\xed, define el modo de creaci\xf3n",(0,n.jsx)(s.br,{}),"\n","para todos los selectores de registros que sigan hasta el pr\xf3ximo par\xe1metro ",(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.code,{children:"$FileCreateMode"})}),".",(0,n.jsx)(s.br,{}),"\n","El orden de las l\xedneas es vitalmente importante."]}),"\n",(0,n.jsx)(s.h4,{id:"justificaci\xf3n-10",children:"Justificaci\xf3n:"}),"\n",(0,n.jsxs)(s.p,{children:["Es importante asegurarse de que los archivos de registro tengan los permisos correctos",(0,n.jsx)(s.br,{}),"\n","para garantizar que los datos sensibles sean archivados y protegidos."]}),"\n",(0,n.jsxs)(s.blockquote,{children:["\n",(0,n.jsxs)(s.p,{children:["\u2139 ",(0,n.jsx)(s.strong,{children:"Nota:"}),":\r\nEsta recomendaci\xf3n ",(0,n.jsx)(s.strong,{children:"solo aplica si rsyslog es el m\xe9todo elegido para el registro de logs"}),".",(0,n.jsx)(s.br,{}),"\n","No aplique esta recomendaci\xf3n si ",(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.code,{children:"systemd-journald"})})," est\xe1 en uso."]}),"\n"]}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(s.h4,{id:"auditor\xeda-10",children:"Auditor\xeda:"}),"\n",(0,n.jsxs)(s.p,{children:["Ejecute el siguiente comando para verificar ",(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.code,{children:"$FileCreateMode"})}),":"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"# grep -Ps '^\\h*\\$FileCreateMode\\h+[0,2,4,6][0,2,4,6][0,2,4,6][0,2,4,6]\\b' /etc/rsyslog.conf /etc/rsyslog.d/*.conf\n"})}),"\n",(0,n.jsx)(s.p,{children:"Verifique que la salida incluya 0640 o m\xe1s restrictivos:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"$FileCreateMode 0640\n"})}),"\n",(0,n.jsx)(s.p,{children:"Si una pol\xedtica del sitio dicta permisos menos restrictivos, aseg\xfarese de cumplir dicha pol\xedtica."}),"\n",(0,n.jsxs)(s.blockquote,{children:["\n",(0,n.jsxs)(s.p,{children:["\u2139 ",(0,n.jsx)(s.strong,{children:"Nota:"}),": Los permisos m\xe1s restrictivos, como 0600, son impl\xedcitamente suficientes."]}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"remediaci\xf3n-8",children:"Remediaci\xf3n:"}),"\n",(0,n.jsxs)(s.p,{children:["Edite el archivo ",(0,n.jsx)(s.strong,{children:"/etc/rsyslog.conf"})," o un archivo ",(0,n.jsx)(s.strong,{children:".conf"})," dedicado en ",(0,n.jsx)(s.strong,{children:"/etc/rsyslog.d/"}),(0,n.jsx)(s.br,{}),"\n","y configure ",(0,n.jsx)(s.strong,{children:"$FileCreateMode"})," a ",(0,n.jsx)(s.strong,{children:"0640"})," o un valor m\xe1s restrictivo:"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"$FileCreateMode 0640\n"})}),"\n",(0,n.jsx)(s.p,{children:"Reiniciar el servicio:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"# systemctl restart rsyslog\n"})}),"\n",(0,n.jsx)(s.h4,{id:"referencias-7",children:"Referencias:"}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsx)(s.li,{children:"RSYSLOG.CONF(5)"}),"\n",(0,n.jsx)(s.li,{children:"NIST SP 800-53 Rev. 5: AC-3, AC-6, MP-2"}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"https://www.rsyslog.com/doc/",children:"Documentaci\xf3n de Rsyslog"})}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"https://www.rsyslog.com/doc/configuration/action/rsconf1_filecreatemode.html#filecreatemode",children:"Configuraci\xf3n de $FileCreateMode en Rsyslog"})}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"controles-cis-10",children:"Controles CIS:"}),"\n",(0,n.jsx)(s.h2,{id:"mapeo-mitre-attck",children:"Mapeo MITRE ATT&CK:"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"T\xe9cnicas / Subt\xe9cnicas"}),(0,n.jsx)(s.th,{children:"T\xe1cticas"}),(0,n.jsx)(s.th,{children:"Mitigaciones"})]})}),(0,n.jsx)(s.tbody,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"T1070, T1070.002, T1083, T1083.000"}),(0,n.jsx)(s.td,{children:"TA0007"}),(0,n.jsx)(s.td,{children:"M1022"})]})})]}),"\n",(0,n.jsx)(s.h3,{id:"6235-asegurar-que-rsyslog-est\xe9-configurado-manual",children:"6.2.3.5 Asegurar que rsyslog est\xe9 configurado (Manual)"}),"\n",(0,n.jsx)(s.h4,{id:"aplicabilidad-del-perfil-11",children:"Aplicabilidad del Perfil:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.strong,{children:"Nivel 1 - Servidor"})}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.strong,{children:"Nivel 1 - Estaci\xf3n de trabajo"})}),"\n"]}),"\n",(0,n.jsx)(s.h4,{id:"descripci\xf3n-11",children:"Descripci\xf3n:"}),"\n",(0,n.jsxs)(s.p,{children:["Los archivos ",(0,n.jsx)(s.code,{children:"/etc/rsyslog.conf"})," y ",(0,n.jsx)(s.code,{children:"/etc/rsyslog.d/*.conf"})," especifican reglas para el registro de eventos y qu\xe9 archivos se utilizar\xe1n para registrar ciertas clases de mensajes."]}),"\n",(0,n.jsx)(s.h4,{id:"justificaci\xf3n-11",children:"Justificaci\xf3n:"}),"\n",(0,n.jsxs)(s.p,{children:["Mucha informaci\xf3n cr\xedtica relacionada con la seguridad se env\xeda a trav\xe9s de ",(0,n.jsx)(s.strong,{children:"rsyslog"}),"\r\n(por ejemplo, intentos de ",(0,n.jsx)(s.code,{children:"su"})," exitosos y fallidos, intentos de inicio de sesi\xf3n fallidos, intentos de inicio de sesi\xf3n como root, etc.)."]}),"\n",(0,n.jsxs)(s.blockquote,{children:["\n",(0,n.jsxs)(s.p,{children:["\u2139 ",(0,n.jsx)(s.strong,{children:"Nota:"}),": Esta recomendaci\xf3n solo aplica si ",(0,n.jsx)(s.strong,{children:"rsyslog"})," es el m\xe9todo elegido para el registro del lado del cliente.",(0,n.jsx)(s.br,{}),"\n","No aplicar esta recomendaci\xf3n si ",(0,n.jsx)(s.strong,{children:"journald"})," est\xe1 en uso."]}),"\n"]}),"\n",(0,n.jsx)(s.h4,{id:"auditor\xeda-11",children:"Auditor\xeda:"}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsxs)(s.li,{children:["Revisar el contenido de los archivos de configuraci\xf3n:","\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"cat /etc/rsyslog.conf\r\ncat /etc/rsyslog.d/*.conf\n"})}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(s.h4,{id:"remediaci\xf3n-9",children:"Remediaci\xf3n:"}),"\n",(0,n.jsx)(s.h3,{id:"edici\xf3n-de-archivos-de-configuraci\xf3n",children:"Edici\xf3n de archivos de configuraci\xf3n"}),"\n",(0,n.jsx)(s.p,{children:"Edite las siguientes l\xedneas en los archivos:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.code,{children:"/etc/rsyslog.conf"})}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.code,{children:"/etc/rsyslog.d/*.conf"})}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:"seg\xfan corresponda a su entorno."}),"\n",(0,n.jsxs)(s.blockquote,{children:["\n",(0,n.jsxs)(s.p,{children:["\u2139 ",(0,n.jsx)(s.strong,{children:"Nota:"}),": La configuraci\xf3n a continuaci\xf3n se proporciona solo con fines ilustrativos. Se debe considerar cuidadosamente c\xf3mo la organizaci\xf3n desea almacenar los datos de registro."]}),"\n"]}),"\n",(0,n.jsx)(s.h3,{id:"ejemplo-de-configuraci\xf3n",children:"Ejemplo de configuraci\xf3n:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-plaintext",children:"*.emerg                         :omusrmsg:*\r\nauth,authpriv.*                  /var/log/secure\r\nmail.*                           -/var/log/mail\r\nmail.info                        -/var/log/mail.info\r\nmail.warning                     -/var/log/mail.warn\r\nmail.err                         -/var/log/mail.err\r\ncron.*                           /var/log/cron\r\n*.warning;*.=err                 -/var/log/warn\r\n*.crit                           -/var/log/warn\r\n*.*;mail.none;news.none          -/var/log/messages\r\nlocal0,local1.*                  -/var/log/localmessages\r\nlocal2,local3.*                  -/var/log/localmessages\r\nlocal4,local5.*                  -/var/log/localmessages\r\nlocal6,local7.*                  -/var/log/localmessages\n"})}),"\n",(0,n.jsxs)(s.p,{children:["Ejecute el siguiente comando para recargar la configuraci\xf3n de ",(0,n.jsx)(s.code,{children:"rsyslogd"}),":"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"# systemctl restart rsyslog\n"})}),"\n",(0,n.jsx)(s.h4,{id:"referencias-8",children:"Referencias:"}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsxs)(s.li,{children:["Consulte la p\xe1gina de manual ",(0,n.jsx)(s.code,{children:"rsyslog.conf(5)"})," para obtener m\xe1s informaci\xf3n."]}),"\n",(0,n.jsx)(s.li,{children:"NIST SP 800-53 Rev. 5: AU-2, AU-7, AU-12"}),"\n"]}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(s.h2,{id:"controles-cis-11",children:"Controles CIS:"}),"\n",(0,n.jsx)(s.h2,{id:"mapeos-de-mitre-attck",children:"Mapeos de MITRE ATT&CK:"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"T\xe9cnicas / Subt\xe9cnicas"}),(0,n.jsx)(s.th,{children:"T\xe1cticas"}),(0,n.jsx)(s.th,{children:"Mitigaciones"})]})}),(0,n.jsx)(s.tbody,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"T1070, T1070.002"}),(0,n.jsx)(s.td,{children:"TA0005"}),(0,n.jsx)(s.td,{children:"M1047"})]})})]}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(s.h3,{id:"6236-asegurar-que-rsyslog-est\xe9-configurado-para-enviar-registros-a-un-host-de-registro-remoto-manual",children:"6.2.3.6 Asegurar que rsyslog est\xe9 configurado para enviar registros a un host de registro remoto (Manual)"}),"\n",(0,n.jsx)(s.h4,{id:"aplicabilidad-del-perfil-12",children:"Aplicabilidad del Perfil:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.strong,{children:"Nivel 1 - Servidor"})}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.strong,{children:"Nivel 1 - Estaci\xf3n de trabajo"})}),"\n"]}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(s.h4,{id:"descripci\xf3n-12",children:"Descripci\xf3n:"}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.code,{children:"rsyslog"})," admite la capacidad de enviar eventos de registro que recopila a un host de registro remoto o recibir mensajes de hosts remotos, lo que permite la gesti\xf3n centralizada de registros."]}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(s.h4,{id:"justificaci\xf3n-12",children:"Justificaci\xf3n:"}),"\n",(0,n.jsx)(s.p,{children:"Almacenar datos de registro en un host remoto protege la integridad de los registros frente a ataques locales. Si un atacante obtiene acceso root en el sistema local, podr\xeda manipular o eliminar los datos de registro almacenados en el sistema local."}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsxs)(s.blockquote,{children:["\n",(0,n.jsxs)(s.p,{children:["\u2139 ",(0,n.jsx)(s.strong,{children:"Nota:"})," Esta recomendaci\xf3n solo se aplica si ",(0,n.jsx)(s.code,{children:"rsyslog"})," es el m\xe9todo elegido para el registro del lado del cliente. No aplique esta recomendaci\xf3n si se usa ",(0,n.jsx)(s.code,{children:"systemd-journald"}),"."]}),"\n"]}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(s.h4,{id:"auditor\xeda-12",children:"Auditor\xeda:"}),"\n",(0,n.jsxs)(s.p,{children:["Revisar los archivos ",(0,n.jsx)(s.code,{children:"/etc/rsyslog.conf"})," y ",(0,n.jsx)(s.code,{children:"/etc/rsyslog.d/*.conf"})," y verificar que los registros se env\xeden a un host central:"]}),"\n",(0,n.jsxs)(s.blockquote,{children:["\n",(0,n.jsxs)(s.p,{children:["\u2139 ",(0,n.jsx)(s.strong,{children:"Nota:"}),": El ",(0,n.jsx)(s.strong,{children:"formato b\xe1sico"})," est\xe1 destinado a usuarios que configuraron su archivo utilizando ",(0,n.jsx)(s.code,{children:"@loghost.example.com"}),".",(0,n.jsx)(s.br,{}),"\n","El ",(0,n.jsx)(s.strong,{children:"formato avanzado"})," es un formato m\xe1s moderno que auditar\xe1 el formato de manera similar a la utilizada en la remediaci\xf3n."]}),"\n"]}),"\n",(0,n.jsx)(s.h4,{id:"formato-b\xe1sico",children:"Formato b\xe1sico:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-sh",children:'grep "^*.*[^1][^I]*@" /etc/rsyslog.conf /etc/rsyslog.d/*.conf\n'})}),"\n",(0,n.jsxs)(s.p,{children:["La salida debe incluir ",(0,n.jsx)(s.code,{children:"@@<FQDN o IP del loghost remoto>"}),":"]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"Ejemplo:"})}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-sh",children:"*.* @@loghost.example.com\n"})}),"\n",(0,n.jsx)(s.h4,{id:"formato-avanzado",children:"formato avanzado"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-sh",children:'# grep -Psi -- \'^\\s*([^#]+\\s+)?action\\(([^#]+\\s+)?\\btarget=\\"?[^#"]+\\"?\\b\' /etc/rsyslog.conf /etc/rsyslog.d/*.conf\n'})}),"\n",(0,n.jsxs)(s.p,{children:["La salida debe incluir ",(0,n.jsx)(s.code,{children:"target=<FQDN or IP of remote loghost>"}),":"]}),"\n",(0,n.jsx)(s.h4,{id:"ejemplo-3",children:"Ejemplo:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-sh",children:'*.* action(type="omfwd" target="loghost.example.com" port="514" protocol="tcp"\n'})}),"\n",(0,n.jsx)(s.h4,{id:"remediaci\xf3n-10",children:"Remediaci\xf3n:"}),"\n",(0,n.jsxs)(s.p,{children:["Edite los archivos ",(0,n.jsx)(s.code,{children:"/etc/rsyslog.conf"})," y ",(0,n.jsx)(s.code,{children:"/etc/rsyslog.d/*.conf"})," y agregue la siguiente l\xednea (donde loghost.example.com es el nombre de su host de registro central). El ",(0,n.jsx)(s.code,{children:"target"})," de destino puede ser un nombre de dominio completo o una direcci\xf3n IP."]}),"\n",(0,n.jsx)(s.h4,{id:"ejemplo-4",children:"Ejemplo:"})]})}function u(e={}){const{wrapper:s}={...(0,a.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(t,{...e})}):t(e)}},8453:(e,s,i)=>{i.d(s,{R:()=>l,x:()=>d});var r=i(6540);const n={},a=r.createContext(n);function l(e){const s=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function d(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:l(e.components),r.createElement(a.Provider,{value:s},e.children)}}}]);