---
title: 6.2.2.1.2
tags: [Torre Unix, IST]
sidebar_position: 3
---
## 6.2.2.1.2 Asegurar que la autenticaciÃ³n de systemd-journal-upload estÃ© configurada (Manual)

### Aplicabilidad del perfil:
- Nivel 1 - Servidor
- Nivel 1 - EstaciÃ³n de trabajo

### DescripciÃ³n:
Journal **systemd-journal-upload** admite la capacidad de enviar eventos de registro que recopila a un host de registro remoto.

### JustificaciÃ³n:
Almacenar datos de registro en un host remoto protege la integridad de los registros contra ataques locales. Si un atacante obtiene acceso root en el sistema local, podrÃ­a manipular o eliminar datos de registro almacenados en el sistema local.

> â„¹ **Nota:** Esta recomendaciÃ³n **solo aplica si journald es el mÃ©todo elegido para el registro del cliente**. No aplique esta recomendaciÃ³n si se utiliza **rsyslog**.

### AuditorÃ­a:
Ejecute el siguiente comando para verificar que la autenticaciÃ³n de **systemd-journal-upload** estÃ¡ configurada:

```bash
grep -P "^ *URL=|^ *ServerKeyFile=|^ *ServerCertificateFile=|^ *TrustedCertificateFile=" /etc/systemd/journal-upload.conf
```

Verifique que la salida coincida con las ubicaciones de los certificados de su entorno y la URL del servidor de registros:

```bash
[Upload] 
URL=192.168.50.42
ServerKeyFile=/etc/ssl/private/journal-upload.pem
ServerCertificateFile=/etc/ssl/certs/journal-upload.pem
TrustedCertificateFile=/etc/ssl/ca/trusted.pem
```

### RemediaciÃ³n:
Edite el archivo `/etc/systemd/journal-upload.conf` o un archivo en  
`/etc/systemd/journal-upload.conf.d` con la extensiÃ³n `.conf` y asegÃºrese de que las siguientes lÃ­neas estÃ©n configuradas en la secciÃ³n `[Upload]` segÃºn su entorno:

```bash
[Upload]
URL=192.168.50.42
ServerKeyFile=/etc/ssl/private/journal-upload.pem
ServerCertificateFile=/etc/ssl/certs/journal-upload.pem
TrustedCertificateFile=/etc/ssl/ca/trusted.pem
```

Reiniciar el servicio:

```bash
systemctl restart systemd-journal-upload
```

### Referencias
1. NIST SP 800-53 Rev. 5: AU-2, AU-12

## Controles CIS

| VersiÃ³n | Control | IG 1 | IG 2 | IG 3 |
|---------|---------|------|------|------|
| **v8**  | **8.2 Recopilar registros de auditorÃ­a**: Recopile registros de auditorÃ­a. AsegÃºrese de que el registro, segÃºn el proceso de gestiÃ³n de registros de auditorÃ­a de la empresa, se haya habilitado en todos los activos empresariales. | ğŸŸ¢ | ğŸŸ  | ğŸ”µ |
| **v7**  | **6.2 Activar el registro de auditorÃ­a**: AsegÃºrese de que el registro local se haya habilitado en todos los sistemas y dispositivos de red. | ğŸŸ¢ | ğŸŸ  | ğŸ”µ |
| **v7**  | **6.3 Habilitar el registro detallado**: Habilite el registro del sistema para incluir informaciÃ³n detallada, como la fuente del evento, fecha, usuario, marca de tiempo, direcciones de origen, direcciones de destino y otros elementos Ãºtiles. |  | ğŸŸ  | ğŸ”µ |

## Mapeo de MITRE ATT&CK

| TÃ©cnicas / SubtÃ©cnicas | TÃ¡cticas | Mitigaciones |
|------------------------|---------|-------------|
| T1070, T1070.002, T1562, T1562.006 | TA0040 | M1029 |

